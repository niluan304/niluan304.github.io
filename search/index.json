[{"content":"è¿™æ®µæ—¶é—´é¢è¯•ï¼Œé‡åˆ°äº†ä¸€é“å’Œå®é™…ç”Ÿäº§ç›¸å…³çš„é¢è¯•é¢˜ï¼š\nç°æœ‰ä¸€ç³»ç»Ÿï¼Œç§¯åˆ†ä½¿ç”¨ MongoDB å­˜å‚¨ï¼Œç‚¹åˆ¸å­˜å‚¨åœ¨ MySQLã€‚\nç”¨æˆ·é€šè¿‡æ—¥å¸¸ä»»åŠ¡è·å–ç§¯åˆ†ï¼Œç‚¹åˆ¸åˆ™å¯ä»¥æç°ã€‚\nç°æ¨å‡ºä¸€æ´»åŠ¨ 1000 ç§¯åˆ†å…‘æ¢ 10 ç‚¹åˆ¸ï¼Œæ€ä¹ˆå®ç°ï¼Ÿ\nå’Œç¼“å­˜ä¸€è‡´æ€§çš„ä¸åŒ å¯¹äºè¿™ç§è·¨æ•°æ®åº“ä¹‹é—´çš„æ“ä½œï¼Œå¯èƒ½ä¼šè¯¯è®¤ä¸ºç±»ä¼¼ã€Œå¦‚ä½•å®ç° MySQL å’Œ Redis çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿã€ï¼Œä½†ä¸¤è€…ä¹‹é—´å…¶å®å¾ˆä¸åŒï¼ŒRedis åœ¨è¿™ç§åœºæ™¯ä¸€èˆ¬ç”¨äºå……å½“è¿œç¨‹ç¼“å­˜æˆ–åˆ†å¸ƒå¼ç¼“å­˜æ•°æ®åº“ï¼Œå…¶æœ¬è´¨ä¸Šæ˜¯å°†æ•°æ®ä»æ”¯æŒæŒä¹…åŒ–ä½†æ…¢é€Ÿçš„ç£ç›˜ä¸­ï¼Œæ¬åˆ°æ–­ç”µä¸¢å¤±ä½†é«˜é€Ÿçš„å†…å­˜ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å®ç° MySQLã€Redis æ•°æ®ä¸€è‡´æ€§æ—¶ï¼Œæˆ‘ä»¬æ“ä½œçš„ä»æ˜¯åŒä¸€ä»½æ•°æ®ï¼Œè€ƒè™‘å¾—æ¯”è¾ƒå¤šçš„æ˜¯é¿å…ç”¨æˆ·è¯»å–åˆ°è„æ•°æ®ï¼ˆæ—§æ•°æ®ï¼‰ã€‚\nè€Œé¢˜ç›®çš„è¦æ±‚å…¶å®æ˜¯ï¼šå¦‚ä½•è§£å†³åˆ†å¸ƒå¼æ•°æ®åº“åœ¨åŒå†™æ—¶çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ\nåˆ†å¸ƒå¼äº‹åŠ¡ é¢è¯•çš„æ—¶å€™ï¼Œç¬”è€…è”æƒ³åˆ°äº†è·¨è¡Œè½¬è´¦ï¼Œè·¨è¡Œè½¬è´¦ä¸šåŠ¡æœ‰ä¸‰ç§æƒ…å†µï¼š\nç›¸åŒæ”¯è¡Œä¸‹çš„è½¬è´¦ï¼šåŒä¸€æ”¯è¡Œå†…çš„è½¬è´¦ï¼ˆæœ¬åœ°äº‹åŠ¡ï¼‰ ä¸åŒæ”¯è¡Œä¸‹çš„è½¬è´¦ï¼šç›¸åŒé“¶è¡Œï¼Œä¸åŒæ”¯è¡Œä¸‹çš„è½¬è´¦ ï¼ˆåˆ†å¸ƒå¼äº‹åŠ¡ï¼‰ è·¨è¡Œè½¬è´¦ï¼šå’Œå…¶ä»–é“¶è¡Œç³»ç»Ÿè¿›è¡Œè½¬è´¦ ï¼ˆåˆ†å¸ƒå¼äº‹åŠ¡ï¼‰ å‡è®¾é“¶è¡Œä»¥æ”¯è¡Œä¸ºæœ€å°å•ä½ï¼Œè¿›è¡Œæ•°æ®åº“éƒ¨ç½²\nè€Œè¿™é“é¢˜å¾ˆåƒåœºæ™¯äºŒï¼Œæ¯”å¦‚ã€Œç”¨æˆ·A æ˜¯å·¥è¡Œæ·±åœ³æ”¯è¡Œçš„ç”¨æˆ·ï¼Œç”¨æˆ·B æ˜¯å·¥è¡Œå¹¿å·æ”¯è¡Œçš„ç”¨æˆ·ï¼ŒAå‘Bè½¬è´¦100å…ƒã€ï¼Œè™½ç„¶éƒ½æ˜¯ A å’Œ B éƒ½æ˜¯å·¥è¡Œç”¨æˆ·ï¼Œä½†æ˜¯ A å’Œ B çš„æ•°æ®å¹¶ä¸åœ¨åŒä¸€ä¸ªæ•°æ®åº“ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸¤ä¸ªæ•°æ®åº“ä¹‹é—´çš„è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œè¿™æ—¶å€™æ— æ³•é€šè¿‡æœ¬åœ°æ•°æ®åº“çš„äº‹åŠ¡å®ç° ACIDï¼Œä¸€èˆ¬é€šè¿‡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³çš„ã€‚\næŸ¥è¯¢ç¡®è®¤äº‹åŠ¡ç»“æœ åœºæ™¯äºŒä¸‹ï¼Œå¯ä»¥è®¤ä¸ºåœ¨å·¥è¡Œè¿™ä¸ªå¤§ç³»ç»Ÿï¼Œå†…éƒ¨æœ‰ç”±æ·±åœ³æ”¯è¡Œå’Œå¹¿å·æ”¯è¡Œçš„è¿™æ ·å¾®æœåŠ¡ç»„æˆï¼Œè€Œå¾®æœåŠ¡ä¹‹é—´çš„ä¸šåŠ¡æµè½¬ç›¸å¯¹ç®€å•ä¸€äº›ï¼š\næ·±åœ³æ”¯è¡Œæ‰£é™¤ç”¨æˆ·A çš„100å…ƒã€‚ æ·±åœ³æ”¯è¡Œé€šçŸ¥å¹¿å·æ”¯è¡Œï¼Œç”¨æˆ·Aè¦è½¬è´¦ 100å…ƒ ç»™ç”¨æˆ·Bã€‚ æ·±åœ³æ”¯è¡Œå®šæ—¶å‘å¹¿å·æ”¯è¡ŒæŸ¥è¯¢æ˜¯å¦æ”¶åˆ°äº†è½¬è´¦ï¼Œå¦‚æœå¤±è´¥äº†é‚£å°±å›æ»šã€‚ å…·ä½“æµç¨‹å¤§æ¦‚æ˜¯è¿™æ ·ï¼š\næ·±åœ³æ”¯è¡Œçš„ç”¨æˆ·A å‘èµ·è½¬è´¦è¯·æ±‚ï¼Œå¼€å¯äº‹åŠ¡ æ·±åœ³æ”¯è¡Œåˆ›å»ºè½¬è´¦è®¢å•ï¼Œè®°å½•ç”¨æˆ·A çš„æ”¯å‡ºå’Œè½¬è´¦å‰åç‚¹åˆ¸ï¼Œä¸”çŠ¶æ€è®¾ç½®ä¸ºã€Œæ”¯å‡ºä¸­ã€ æ·±åœ³æ”¯è¡Œé€šçŸ¥å¹¿å·æ”¯è¡Œï¼Œç”¨æˆ·A å‘ ç”¨æˆ·B è½¬è´¦ï¼Œå¹¿å·æ”¯è¡Œæ”¶åˆ°é€šçŸ¥åï¼š å¼€å¯äº‹åŠ¡ åˆ›å»ºè½¬è´¦è®¢å•ï¼Œè®°å½•ç”¨æˆ·B çš„æ”¶å…¥å’Œè½¬è´¦å‰åç‚¹åˆ¸ï¼Œä¸”çŠ¶æ€è®¾ç½®ä¸ºã€Œæ”¶å…¥ä¸­ã€ æ›´æ–°è®¢å•çŠ¶æ€ï¼Œå¹¶è¿”å›è½¬è´¦ç»“æœç»™æ·±åœ³æ”¯è¡Œ æ·±åœ³æ”¯è¡Œæ”¶åˆ°å¹¿å·æ”¯è¡Œçš„å›å¤ï¼š æˆåŠŸï¼šè½¬è´¦è®¢å•çŠ¶æ€æ›´æ–°ä¸ºã€ŒæˆåŠŸã€ï¼Œæäº¤äº‹åŠ¡ å¤±è´¥ï¼šè½¬è´¦è®¢å•çŠ¶æ€æ›´æ–°ä¸ºã€Œå¤±è´¥ã€ï¼Œå›æ»šäº‹åŠ¡ %% æ—¶åºå›¾ [Markdown è¿›é˜¶æŠ€èƒ½ï¼šç”¨ä»£ç ç”»æ—¶åºå›¾](https://zhuanlan.zhihu.com/p/70261692) %% -\u0026gt;\u0026gt;å®çº¿ç®­å¤´ ä»£è¡¨ä¸»åŠ¨å‘å‡ºæ¶ˆæ¯ï¼›--\u0026gt;è™šçº¿ä»£è¡¨å“åº”ï¼›æœ«å°¾å¸¦ã€ŒXã€ä»£è¡¨å¼‚æ­¥æ¶ˆæ¯ï¼Œæ— éœ€ç­‰å¾…å›åº”ã€‚ sequenceDiagram participant ç”¨æˆ·A participant æ·±åœ³æ”¯è¡Œ participant å¹¿å·æ”¯è¡Œ participant ç”¨æˆ·B ç”¨æˆ·A -\u0026gt;\u0026gt; + æ·±åœ³æ”¯è¡Œ: å‘ç”¨æˆ·B è½¬è´¦ æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: åˆ›å»ºè½¬è´¦è®¢å•ï¼ŒçŠ¶æ€ PAYOUT æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: äº‹åŠ¡ BEGIN æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; + å¹¿å·æ”¯è¡Œ: Aå‘Bè½¬è´¦ å¹¿å·æ”¯è¡Œ -\u0026gt;\u0026gt; ç”¨æˆ·B: æ‰§è¡Œè½¬è´¦æ“ä½œ ç”¨æˆ·B --\u0026gt;\u0026gt; å¹¿å·æ”¯è¡Œ: è½¬è´¦ç»“æœ alt è½¬è´¦æˆåŠŸ ç”¨æˆ·B --\u0026gt;\u0026gt; å¹¿å·æ”¯è¡Œ: è®¢å•çŠ¶æ€ SUCC else è½¬è´¦å¤±è´¥ ç”¨æˆ·B --\u0026gt;\u0026gt; å¹¿å·æ”¯è¡Œ: è®¢å•çŠ¶æ€ FAIL end å¹¿å·æ”¯è¡Œ --\u0026gt;\u0026gt; - æ·±åœ³æ”¯è¡Œ: è½¬è´¦ç»“æœ alt è½¬è´¦æˆåŠŸ æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: è®¢å•çŠ¶æ€ SUCC æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: äº‹åŠ¡ COMMIT else è½¬è´¦å¤±è´¥ æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: è®¢å•çŠ¶æ€ FAIL æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: äº‹åŠ¡ ROLLBAK end æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; - ç”¨æˆ·A: æ”¶åˆ°è½¬è´¦ç»“æœ åœ¨ä¸Šè¿°æµç¨‹æ˜¯åŒæ­¥çš„ï¼Œç”¨æˆ·éœ€è¦åœ¨è½¬è´¦ç•Œé¢ç­‰å¾…è½¬è´¦ç»“æœï¼Œå¦‚æœè½¬è´¦è€—æ—¶è¿‡ä¹…ï¼Œä¼šå½±å“åˆ°ç”¨æˆ·ä½“éªŒã€‚å¯ä»¥å°†è½¬è´¦ç»“æœæ”¹æˆå¼‚æ­¥äº‹ä»¶ã€‚\nåœ¨ç”¨æˆ·æäº¤è½¬è´¦è¯·æ±‚åï¼Œè¿”å›æç¤ºï¼šã€Œè½¬è´¦è¯·æ±‚å·²æäº¤ï¼Œè¯·ç¨åæŸ¥çœ‹è½¬è´¦ç»“æœã€ï¼Œç”¨æˆ·å°±å¯ä»¥å…ˆæµè§ˆå…¶ä»–é¡µé¢ï¼Œç­‰å¾…è½¬è´¦ç»“æœçš„æ¨é€ã€‚\n%% æ—¶åºå›¾ [Markdown è¿›é˜¶æŠ€èƒ½ï¼šç”¨ä»£ç ç”»æ—¶åºå›¾](https://zhuanlan.zhihu.com/p/70261692) %% -\u0026gt;\u0026gt;å®çº¿ç®­å¤´ ä»£è¡¨ä¸»åŠ¨å‘å‡ºæ¶ˆæ¯ï¼›--\u0026gt;è™šçº¿ä»£è¡¨å“åº”ï¼›æœ«å°¾å¸¦ã€ŒXã€ä»£è¡¨å¼‚æ­¥æ¶ˆæ¯ï¼Œæ— éœ€ç­‰å¾…å›åº”ã€‚ sequenceDiagram participant ç”¨æˆ·A participant æ·±åœ³æ”¯è¡Œ participant å¹¿å·æ”¯è¡Œ participant ç”¨æˆ·B ç”¨æˆ·A -\u0026gt;\u0026gt; + æ·±åœ³æ”¯è¡Œ: å‘ç”¨æˆ·Bè½¬è´¦ æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: åˆ›å»ºè½¬è´¦è®¢å•ï¼ŒçŠ¶æ€ PAYOUT æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; - ç”¨æˆ·A: ç¨åæŸ¥çœ‹è½¬è´¦ç»“æœ æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; + æ·±åœ³æ”¯è¡Œ: äº‹åŠ¡ BEGIN æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; å¹¿å·æ”¯è¡Œ: Aå‘Bè½¬è´¦ å¹¿å·æ”¯è¡Œ -\u0026gt;\u0026gt; ç”¨æˆ·B: æ‰§è¡Œè½¬è´¦æ“ä½œ ç”¨æˆ·B --\u0026gt;\u0026gt; å¹¿å·æ”¯è¡Œ: è½¬è´¦ç»“æœ loop å®šæ—¶æŸ¥è¯¢ æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; å¹¿å·æ”¯è¡Œ: è½¬è´¦è®¢å•çŠ¶æ€ å¹¿å·æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: è½¬è´¦è®¢å•ç»“æœ end alt è½¬è´¦æˆåŠŸ æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: è®¢å•çŠ¶æ€ SUCC æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: äº‹åŠ¡ COMMIT else è½¬è´¦å¤±è´¥ æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; æ·±åœ³æ”¯è¡Œ: è®¢å•çŠ¶æ€ FAIL æ·±åœ³æ”¯è¡Œ --\u0026gt;\u0026gt; - æ·±åœ³æ”¯è¡Œ: äº‹åŠ¡ ROLLBACK end æ·±åœ³æ”¯è¡Œ -\u0026gt;\u0026gt; ç”¨æˆ·A: è½¬è´¦ç»“æœ äºŒé˜¶æ®µæäº¤åè®® 2PC ä¸ MySQLå•æœºä¸­çš„ 2PL æœ‰ç›¸ä¼¼ç‚¹ï¼Œéƒ½æœ‰ä¸¤ä¸ªé˜¶æ®µï¼Œä½†é€‚ç”¨çš„ç›®æ ‡æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸èƒ½æ··æ·†ã€‚\näºŒé˜¶æ®µåŠ é”åè®®ï¼ˆTwo-Phase Locking, 2PLï¼‰ï¼šä¸€ç§ç”¨äºç®¡ç†æ•°æ®åº“äº‹åŠ¡å¹¶å‘æ§åˆ¶çš„åè®®ï¼Œä¸»è¦ç›®çš„æ˜¯é˜²æ­¢å¤šä¸ªäº‹åŠ¡åŒæ—¶ä¿®æ”¹åŒä¸€æ•°æ®é¡¹ï¼Œä»¥é¿å…æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå®ç°å¯åºåˆ—åŒ–çš„éš”ç¦»ç­‰çº§ã€‚ äºŒé˜¶æ®µæäº¤åè®®ï¼ˆTwo-Phase Commit, 2PCï¼‰ ï¼šä¸€ç§ç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åŸå­æ€§æ“ä½œçš„åè®®ï¼Œç¡®ä¿æ‰€æœ‰çš„äº‹åŠ¡å‚ä¸è€…è¦ä¹ˆå…¨éƒ¨æäº¤ï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šï¼Œä»è€Œä¿è¯åˆ†å¸ƒå¼äº‹åŠ¡çš„å®Œæ•´æ€§ã€‚ 2PC çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š 2PCçš„ç›¸å…³å†…å®¹ï¼Œè§è®¾è®¡å¯†é›†å‹åº”ç”¨ï¼ˆDesigning Data-Intensive Applications, DDIAï¼‰ã€Œç¬¬ä¹ç« ï¼šä¸€è‡´æ€§ä¸å…±è¯†ã€ï¼Œç¬”è€…å°±ä¸èµ˜è¿°äº†ã€‚\nä¾èµ–å…³ç³»ï¼šMySQL ä¸ºä¸» é¢è¯•å®˜è¡¨ç¤ºåˆ†å¸ƒå¼äº‹åŠ¡æ˜¯æ›´é€šç”¨çš„è§£å†³æ–¹æ³•ï¼Œå¦‚æœç”¨åˆ° MySQL å’Œ MongoDB éƒ½æ˜¯æœ¬åœ°æ•°æ®åº“è¿™ä¸ªæ¡ä»¶ï¼Œè¿™é¢˜å¯ä»¥æœ‰æ›´å¥½çš„å¤„ç†æ–¹æ³•ã€‚é¢è¯•ç»“æŸåï¼Œä¼Ÿå¤§çš„äº’è”ç½‘å‘Šè¯‰ç¬”è€…ç¡®å®å¦‚æ­¤ã€‚\nMySQL å­˜å‚¨ç‚¹åˆ¸ï¼ŒMongoDB å­˜å‚¨ç§¯åˆ†ï¼Œå¾ˆæ˜æ˜¾ç‚¹åˆ¸æ˜¯æ ¸å¿ƒæ•°æ®ï¼Œé‚£ä¹ˆéœ€è¦ä»¥ MySQL ä¸ºä¸»ï¼Œæ‰€ä»¥MySQL ä¸­åº”è¯¥æœ‰ä¸€ä¸ªå­—æ®µ mongo_id ç”¨äºå…³è” MongoDB çš„ä¸»é”® _idï¼Œè€ŒæŸ¥è¯¢ MongoDB å­˜å‚¨çš„ç§¯åˆ†ï¼Œåªèƒ½é€šè¿‡ MySQL é‡Œ mongo_id å­—æ®µã€‚\nå‡è®¾ MySQL è¡¨ç»“æ„å¦‚ä¸‹ï¼š\nCREATE TABLE wallet ( user_id INT PRIMARY KEY COMMENT \u0026#39;userId\u0026#39;, balance DECIMAL(10, 0) DEFAULT NULL COMMENT \u0026#39;ç‚¹åˆ¸\u0026#39;, mongo_id VARCHAR(64) NOT NULL COMMENT \u0026#39;MongoDB ä¸»é”®id\u0026#39; ); MongoDB æ–‡æ¡£ç»“æ„å¦‚ä¸‹ï¼š\n{ \u0026#34;_id\u0026#34;: \u0026#34;661bcb98cd3500008c007b5c\u0026#34;, \u0026#34;score\u0026#34;: 200 } ä¸»è¦æ€æƒ³æ˜¯å€Ÿé‰´é¢„å†™æ—¥å¿—ï¼ˆWrite Ahead Log, WALï¼‰ï¼Œå®ç° MySQL ä¸ MongoDB çš„åŒå†™ä¸€è‡´æ€§ï¼š\nå¼€å¯ MySQL äº‹åŠ¡ï¼Œé¿å…å¹¶å‘é—®é¢˜ å…ˆåœ¨ MongoDB æ’å…¥ä¿®æ”¹åçš„æ•°æ®ï¼Œè€Œä¸æ˜¯å»æ›´æ–° MongoDB å†æ›´æ–° MySQL çš„ mongo_idã€‚ å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š\n%% æ—¶åºå›¾ [Markdown è¿›é˜¶æŠ€èƒ½ï¼šç”¨ä»£ç ç”»æ—¶åºå›¾](https://zhuanlan.zhihu.com/p/70261692) %% -\u0026gt;\u0026gt;å®çº¿ç®­å¤´ ä»£è¡¨ä¸»åŠ¨å‘å‡ºæ¶ˆæ¯ï¼›--\u0026gt;è™šçº¿ä»£è¡¨å“åº”ï¼›æœ«å°¾å¸¦ã€ŒXã€ä»£è¡¨å¼‚æ­¥æ¶ˆæ¯ï¼Œæ— éœ€ç­‰å¾…å›åº”ã€‚ sequenceDiagram participant ç”¨æˆ· participant ç³»ç»Ÿ participant MySQL participant MongoDB ç”¨æˆ· -\u0026gt;\u0026gt; + ç³»ç»Ÿ: ç§¯åˆ†å…‘æ¢ç‚¹åˆ¸ ç³»ç»Ÿ -\u0026gt;\u0026gt; MySQL: äº‹åŠ¡ BEGIN ç³»ç»Ÿ -\u0026gt;\u0026gt; MySQL: æŸ¥è¯¢ user_id MySQL --\u0026gt;\u0026gt; ç³»ç»Ÿ: è¿”å› blance, mongo_id ç³»ç»Ÿ -\u0026gt;\u0026gt; MongoDB: æŸ¥è¯¢ mongo_id MongoDB --\u0026gt;\u0026gt; ç³»ç»Ÿ: è¿”å› document ç³»ç»Ÿ -\u0026gt;\u0026gt; ç³»ç»Ÿ: document.score -= 100 ç³»ç»Ÿ -\u0026gt;\u0026gt; MongoDB: æ’å…¥ä¿®æ”¹åçš„ document MongoDB --\u0026gt;\u0026gt; ç³»ç»Ÿ: è¿”å› mongo_id ç³»ç»Ÿ -\u0026gt;\u0026gt; MySQL: æ›´æ–° blance, mongo_id MySQL --\u0026gt;\u0026gt; ç³»ç»Ÿ: æ›´æ–°æˆåŠŸ MySQL --\u0026gt;\u0026gt; ç³»ç»Ÿ: äº‹åŠ¡ COMMIT ç³»ç»Ÿ --\u0026gt;\u0026gt; - ç”¨æˆ·: å…‘æ¢å®Œæˆ åœ¨è¿™ä¸ªæµç¨‹ä¸­ï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™å†™å…¥å‡ºé”™ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°æ•°æ®çš„ä¸€è‡´æ€§ã€‚\nå¦‚æœåœ¨ MongoDB æ’å…¥æ–°æ•°æ®æ—¶å‡ºé”™ï¼ŒMySQL ä¸­ä¿å­˜çš„ä»ä¸ºè€æ•°æ®ã€‚ å¦‚æœåœ¨ MySQL æ›´æ–°æ—¶å‡ºé”™ï¼ŒMySQL ä¸­ä¿å­˜çš„ä»ä¸ºè€æ•°æ®ã€‚ ä¸è¿‡è¿™ç§æ–¹æ¡ˆä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼ŒMongoDB ä¼šæ–°å¢ä¸€æ¡æ— æ•ˆçš„åƒåœ¾æ•°æ®ï¼Œè§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š\nå¼‚æ­¥åˆ é™¤ã€‚é€šè¿‡å¸¦æœ‰é‡è¯•æœºåˆ¶çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç›´åˆ°åƒåœ¾æ•°æ®è¢«åˆ é™¤ã€‚ å®šæ—¶å™¨åˆ é™¤ã€‚é€šè¿‡å®šæ—¶å™¨ï¼ŒæŸ¥è¯¢å‡ºè¿‘æ®µæ—¶é—´åƒåœ¾æ•°æ®ï¼Œå¹¶åšåˆ é™¤ã€‚ å‚è€ƒèµ„æ–™ åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ä¿è¯å¤šä¸ªç³»ç»Ÿé—´çš„æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Ÿ å¦‚ä½•ä¿è¯mongodbå’Œæ•°æ®åº“åŒå†™æ•°æ®ä¸€è‡´æ€§ï¼Ÿ åˆ†å¸ƒå¼äº‹åŠ¡æ¦‚è¿° ä¸€è‡´æ€§é—®é¢˜ä¸åˆ†å¸ƒå¼äº‹åŠ¡ ä»¥é“¶è¡Œè½¬è´¦ä¸ºä¾‹åˆ†æåˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆ ","date":"2024-04-15T09:52:02+08:00","permalink":"https://niluan304.github.io/p/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%9C%AC%E5%9C%B0-mysql-%E5%92%8C-mongodb-%E5%8F%8C%E5%86%99%E6%97%B6%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7/","title":"å¦‚ä½•å®ç°æœ¬åœ° MySQL å’Œ MongoDB åŒå†™æ—¶æ•°æ®ä¸€è‡´æ€§"},{"content":" æºä»£ç /æ•°æ®é›†å·²ä¸Šä¼ åˆ°ï¼šGitHub - follow gee to learn go\nGoFrame çš„ ReqResFunc ç±»å‹ åœ¨ day7.5 å¼€ç¯‡çš„æ—¶å€™ï¼Œç¬”è€…æåˆ° GoFrame æ”¯æŒç¬¬äºŒç§è·¯ç”±æ³¨å†Œæ–¹æ³•ï¼Œè¿™é‡Œç¬”è€…ç§°ä¹‹ä¸º ReqResFunc ç±»å‹ï¼ˆä¸‹æ–‡åŒï¼‰ï¼š\n// å†™æ³•äºŒ func (ctx context.Context, req *{Prefix}Req) (res *{Prefix}Res, err error){ // ä¸šåŠ¡ä»£ç é€»è¾‘ } ä½†æ˜¯ day9 å®ç°çš„å‡½æ•°ç­¾åï¼š\nfunc (c *user) Get(ctx context.Context, decode func(point any) (err error)) (data any, err error) å¯¹æ¯”å¯ä»¥å‘ç°ï¼Œå’Œ ReqResFunc ç±»å‹æœ‰æ˜æ˜¾ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ GoFrame çš„æºç é‡Œä¸€æ¢ç©¶ç«Ÿã€‚\nä» GoFrame çš„ æ–‡æ¡£ã€Œè·¯ç”±æ³¨å†Œ-å‡½æ•°æ³¨å†Œã€ä¸­ï¼Œå¯ä»¥æ‰¾åˆ° å…¥å£å‡½æ•°ï¼š\n// https://github.com/gogf/gf/blob/313d9d138f96b0ed460d47684298a7fb26d3fd75/net/ghttp/ghttp_server_service_handler.go#L21-L39 // BindHandler registers a handler function to server with a given pattern. // // Note that the parameter `handler` can be type of: // 1. func(*ghttp.Request) // 2. func(context.Context, BizRequest)(BizResponse, error) func (s *Server) BindHandler(pattern string, handler interface{}) { var ctx = context.TODO() funcInfo, err := s.checkAndCreateFuncInfo(handler, \u0026#34;\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;\u0026#34;) if err != nil { s.Logger().Fatalf(ctx, `%+v`, err) } s.doBindHandler(ctx, doBindHandlerInput{ Prefix: \u0026#34;\u0026#34;, Pattern: pattern, FuncInfo: funcInfo, Middleware: nil, Source: \u0026#34;\u0026#34;, }) } åœ¨æºç é‡Œï¼Œå¯ä»¥å‘ç°å…³é”®ä»£ç åœ¨ checkAndCreateFuncInfo æ–¹æ³•ï¼Œç»§ç»­å‰è¡Œï¼Œå°±èƒ½å¤Ÿå‘ç°ç«¯å€ªï¼š\n// https://github.com/gogf/gf/blob/313d9d138f96b0ed460d47684298a7fb26d3fd75/net/ghttp/ghttp_server_service_handler.go#L148 func (s *Server) checkAndCreateFuncInfo(f interface{}, pkgPath, structName,methodName string,) (funcInfo handlerFuncInfo, err error) { funcInfo = handlerFuncInfo{ // æ ¹æ®ä¼ å…¥çš„ fï¼Œåˆå§‹åŒ–è¿”å›å€¼ Type: reflect.TypeOf(f), Value: reflect.ValueOf(f), } } GoFrame é€šè¿‡åå°„ reflectï¼Œè·å–äº†ä¼ å…¥çš„å‡½æ•°çš„å‚æ•°ä¿¡æ¯ï¼Œå¹¶åšäº†ç›¸åº”çš„æ ¡éªŒï¼Œå…³é”®ä»£ç æœ‰ 5 è¡Œï¼š\n// æ ¡éªŒè¯·æ±‚å’Œè¿”å›çš„å‚æ•°æ•°é‡ if reflectType.NumIn() != 2 || reflectType.NumOut() != 2 // ç¬¬ä¸€ä¸ªè¯·æ±‚å‚æ•°å¿…é¡»ä¸º context.Context ç±»å‹ if !reflectType.In(0).Implements(reflect.TypeOf((*context.Context)(nil)).Elem()) // ç¬¬äºŒä¸ªè¿”å›å‚æ•°å¿…é¡»ä¸º error ç±»å‹ if !reflectType.Out(1).Implements(reflect.TypeOf((*error)(nil)).Elem()) // ç¬¬äºŒä¸ªè¯·æ±‚å‚æ•°å¿…é¡»ä¸ºä»¥ `Req` ç»“å°¾ if !strings.HasSuffix(reflectType.In(1).String(), `Req`) // ç¬¬ä¸€ä¸ªè¿”å›å‚æ•°å¿…é¡»ä¸ºä»¥ `Res` ç»“å°¾ if !strings.HasSuffix(reflectType.Out(0).String(), `Res`) é€šè¿‡è¿™äº›æ ¡éªŒï¼ŒGoFrame å°±å®ç°äº†è§„èŒƒè·¯ç”±å‡½æ•°å¿…é¡»æ˜¯ ResReqFunc ç±»å‹çš„çº¦æŸã€‚æ ¡éªŒè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›ç»†èŠ‚ï¼š\nctx å’Œ error æ˜¯æ¥å£ç±»å‹ï¼Œåªèƒ½è°ƒç”¨ func (Type) Implements(u Type) bool ç¡®è®¤æ˜¯å¦å®ç°äº†å¯¹åº”çš„æ¥å£ï¼Œ(*error)(nil) å’Œ (*context.Context)(nil) åˆ™æ˜¯å£°æ˜äº†å¯¹åº”æ¥å£çš„ç©ºå€¼ nilã€‚ req å’Œ res çš„åˆå§‹ç±»å‹æ˜¯ç»“æ„ä½“ï¼Œå¯ä»¥ç›´æ¥è·å–ç»“æ„ä½“çš„ç±»å‹åã€‚ å®ç° ReqResFunc ç±»å‹çš„çº¦æŸ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»¿ç…§ GoFrameï¼Œå®ç° ResReqFunc ç±»å‹çš„çº¦æŸã€‚é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªç»“æ„ä½“ï¼Œç”¨äºä¿å­˜åå°„è§£æå‡ºæ¥çš„å€¼ï¼š\ntype ReqResFunc struct { fn reflect.Value // å‡½æ•°è°ƒç”¨å…¥å£ ctx reflect.Type // ç¬¬ä¸€ä¸ªè¯·æ±‚å‚æ•°ï¼šcontext.Context req reflect.Type // ç¬¬äºŒä¸ªè¯·æ±‚å‚æ•°ï¼šXXXReq res reflect.Type // ç¬¬ä¸€ä¸ªè¿”å›å‚æ•°ï¼šXXXRes err reflect.Type // ç¬¬äºŒä¸ªè¿”å›å‚æ•°ï¼šerror } å…·ä½“çš„è§£æä»£ç ï¼Œå¯ä»¥å…¨éƒ¨ä»¿ç…§ GoFrame çš„æµç¨‹ï¼Œè·å–å…¥å‚ reqRes çš„åå°„å¯¹è±¡ï¼Œç„¶åé€ä¸ªæ ¡éªŒï¼Œæœ€åå†æ„é€  ReqResFuncã€‚\né‚£ä¹ˆè¿˜å‰©æœ€åä¸€ä¸ªé—®é¢˜ï¼Œ ReqResFunc è¦æ³¨å†Œåˆ° Ginæ¡†æ¶é‡Œå‘¢ï¼Ÿè¿™é‡Œå’Œ day9 é‡åˆ°çš„æƒ…å†µä¸€æ ·ï¼Œè¿˜æ˜¯é‚£å¥åè¨€ï¼š\nAll problems in computer science can be solved by another level of indirection.\nè®¡ç®—æœºç§‘å­¦é¢†åŸŸçš„ä»»ä½•é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªä¸­é—´å±‚æ¥è§£å†³ã€‚\nå€˜è‹¥è§£å†³ä¸äº†ï¼Œé‚£å°±å†åŠ ä¸€ä¸ªä¸­é—´å±‚ï¼Œå› æ­¤å®Œå…¨å¯ä»¥æŠŠ ReqResFunc è½¬æ¢ä¸º DecodeFuncï¼Œå®ç°ä¹Ÿä¸å¤æ‚ï¼š\nfunc (f *ReqResFunc) Call(ctx context.Context, decode func(point any) error) (any, error) { req := reflect.New(f.req.Elem()) point := req.Interface() if err := decode(point); err != nil { return nil, err } result := f.fn.Call([]reflect.Value{reflect.ValueOf(ctx), req}) if err := result[1]; !err.IsNil() { return nil, err.Interface().(error) } return result[0].Interface(), nil } func (f *ReqResFunc) DecodeFunc() DecodeFunc { return f.Call } è€Œ GoFrame ä¹Ÿæ˜¯è¿™æ ·è½¬åŒ–çš„ï¼Œç›¸å…³æºç ï¼š func createRouterFunc(funcInfo handlerFuncInfo) func(r *Request)\néªŒè¯ ReqResFunc ç±»å‹ å¢åŠ äº†ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œåšä¸ªç®€å•æµ‹è¯•ï¼Œé€šè¿‡ teamId è·å–å›¢é˜Ÿæˆå‘˜ï¼š\n// internal/controller/controller.go func (c *team) GetUsers(ctx context.Context, req *TeamGetUsersReq) (res *TeamGetUsersRes, err error) { out, err := service.Team.GetUsers(ctx, \u0026amp;service.TeamGetUsersReq{Id: req.Id}) if err != nil { return nil, err } return \u0026amp;TeamGetUsersRes{TeamGetUsersRes: out}, nil } // internal/service/service.go func (s *team) GetUsers(ctx context.Context, req *TeamGetUsersReq) (res *TeamGetUsersRes, err error) { var users []UserGetRes // æŸ¥è¯¢æ•°æ® // Users åªæ˜¯ä¸€ä¸ªåˆ‡ç‰‡ []Userï¼Œç”¨äºå……å½“æ•°æ®åº“ for _, row := range db.Users { if row.TeamId == req.Id { users = append(users, UserGetRes{Id: row.Id, Name: row.Name, TeamId: row.TeamId}) } } return \u0026amp;TeamGetUsersRes{Users: users}, nil } æµ‹è¯•æ¥å£ï¼š\nfunc Test_Client(t *testing.T) { time.Sleep(time.Second) // ç­‰å¾…æœåŠ¡ç«¯å¯åŠ¨ paths := []string{ \u0026#34;/user/1\u0026#34;, // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;id\u0026#34;:1,\u0026#34;name\u0026#34;:\u0026#34;Alice\u0026#34;,\u0026#34;teamId\u0026#34;:1}} \u0026#34;/user/3\u0026#34;, // {\u0026#34;code\u0026#34;:400,\u0026#34;msg\u0026#34;:\u0026#34;user not found: 3\u0026#34;,\u0026#34;data\u0026#34;:null} \u0026#34;/user/1/team\u0026#34;, // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;id\u0026#34;:1,\u0026#34;name\u0026#34;:\u0026#34;Alice\u0026#34;,\u0026#34;team\u0026#34;:{\u0026#34;id\u0026#34;:3,\u0026#34;name\u0026#34;:\u0026#34;Apple\u0026#34;}}} \u0026#34;/team/3\u0026#34;, // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;id\u0026#34;:3,\u0026#34;name\u0026#34;:\u0026#34;Apple\u0026#34;}} \u0026#34;/team/5\u0026#34;, // {\u0026#34;code\u0026#34;:400,\u0026#34;msg\u0026#34;:\u0026#34;team not found: 5\u0026#34;,\u0026#34;data\u0026#34;:null} \u0026#34;/team/3/users\u0026#34;, // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;users\u0026#34;:[{\u0026#34;id\u0026#34;:1,\u0026#34;name\u0026#34;:\u0026#34;Alice\u0026#34;,\u0026#34;teamId\u0026#34;:3}]}} \u0026#34;/team/5/users\u0026#34;, // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;Users\u0026#34;:null}} } for _, path := range paths { resp, err := http.Get(\u0026#34;http://localhost:8080\u0026#34; + path) if err != nil { fmt.Println(\u0026#34;req err\u0026#34;, err) continue } data, err := io.ReadAll(resp.Body) if err != nil { fmt.Println(\u0026#34;read resp.Body err\u0026#34;, err) continue } fmt.Println(string(data)) } } é€šè¿‡å¯¹è±¡æ³¨å†Œè·¯ç”± äº‹å®ä¸Šï¼ŒGoFrame è¿˜æœ‰ç¬¬ä¸‰ç§è·¯ç”±æ³¨å†Œæ–¹æ³•ï¼šå¯¹è±¡æ³¨å†Œï¼Œå‘ (*ghttp.RouterGroup).Bind ä¼ å…¥ä¸€ä¸ªç»“æ„ä½“å˜é‡ï¼Œç„¶å GoFrame ä¼šå°è¯•æ³¨å†Œè¿™ä¸ªç»“æ„ä½“ä¸Šçš„æ‰€æœ‰ ReqResFunc ç±»å‹çš„æ–¹æ³•ã€‚è¿™ä¹Ÿæ˜¯é€šè¿‡åå°„å®ç°çš„ï¼Œæ ¸å¿ƒä»£ç ä¹Ÿå¾ˆç®€çŸ­ï¼š\nfunc ObjectHandler(object any) (handles []gin.HandlerFunc) { v := reflect.ValueOf(object) // å¦‚æœæ˜¯ç»“æ„ä½“, é‚£ä¹ˆè·å–è¿™ä¸ªç»“æ„ä½“çš„æŒ‡é’ˆ, ä»è€Œéå†åˆ°ä»–çš„æ‰€æœ‰æ–¹æ³• if v.Kind() == reflect.Struct { newValue := reflect.New(v.Type()) newValue.Elem().Set(v) v = newValue } if v.Kind() != reflect.Pointer { panic(\u0026#34;v.Kind() must be reflect.Pointer\u0026#34;) } for i := 0; i \u0026lt; v.NumMethod(); i++ { fn := v.Method(i) // æ‰€æœ‰æ–¹æ³•éƒ½å¿…é¡»ä¸º ReqResFunc ç±»å‹ handles = append(handles, ReqResHandle(fn.Interface())) } return handles } ä½†æ˜¯é€šè¿‡å¯¹è±¡æ³¨å†Œè·¯ç”±æœ‰ä¸ªç¼ºç‚¹ï¼Œéš¾ä»¥ä¸º HandlerFunc ç»‘å®š path å’Œ methodã€‚\nå·²çŸ¥çš„è§£å†³æ–¹å¼ï¼š\nGoFrame æ˜¯åœ¨ Reqï¼ˆç¬¬äºŒä¸ªè¯·æ±‚å‚æ•°ï¼‰é‡Œå†™ go tagï¼Œæœ‰å…´è¶£çš„è¯»è€…ï¼Œå¯ä»¥æŸ¥çœ‹ã€Œæ–‡æ¡£ï¼šè§„èŒƒå‚æ•°ç»“æ„ã€ã€‚ iris è¦æ±‚æ–¹æ³•åï¼ˆå‡½æ•°åï¼‰çš„æ ¼å¼ä¸ºï¼šè¯·æ±‚æ–¹æ³•+è¯·æ±‚è·¯å¾„ï¼Œå¦‚ GetHelloWorld å¯¹åº” GET: /hello/worldï¼Œç¤ºä¾‹ï¼šexamples/mvc/hello-world/main.go ç¬”è€…ä¹Ÿåšäº†ç®€å•çš„å®ç°ï¼šgee/web/day10/handle/handle_test.goï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚\n","date":"2023-12-22T15:43:59+08:00","permalink":"https://niluan304.github.io/p/gee-web-day10-%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E6%9E%84%E9%80%A0%E8%A7%84%E8%8C%83%E8%B7%AF%E7%94%B1/","title":"gee-web-day10 é€šè¿‡åå°„æ„é€ è§„èŒƒè·¯ç”±"},{"content":" æºä»£ç /æ•°æ®é›†å·²ä¸Šä¼ åˆ°ï¼šGitHub - follow gee to learn go\nç»è¿‡åˆ†å±‚å¤„ç†åï¼Œé¡¹ç›®å¸ƒå±€æœ‰äº†å¾ˆå¤§æ”¹å–„ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨é—®é¢˜ã€‚\ncontroller å±‚çš„é”™è¯¯å¤„ç†ä»£ç ç‰¹åˆ«ç¹çï¼Œæœ‰å¤ªå¤šçš„ï¼šctx.JSON(http.StatusOK, Response{400, err.Error(), nil}) controller å±‚åªæ”¯æŒ Gin æ¡†æ¶ï¼Œæ›´ä¸æ”¯æŒå…¶ä»–åè®® è®©è°ƒç”¨è€…å¸®å¿™ååºåˆ—åŒ– è§‚å¯Ÿ controller å±‚å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šcontroller çš„éœ€æ±‚å…¶å®å¾ˆç®€å•ï¼šååºåˆ—åŒ–ä¸º service å±‚æ‰€éœ€è¦ go ç±»å‹ï¼Œå¹¶åœ¨ err != nil æ—¶åšæ§åˆ¶çš„æµè½¬ã€‚\né‚£ä¹ˆè¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿè¿™å…¶å®å¹¶ä¸éš¾ã€‚è¯´åˆ°ååºåˆ—åŒ–ï¼Œç¬”è€…ç›¸ä¿¡å„ä½éƒ½éå¸¸ç†Ÿæ‚‰æ ‡å‡†åº“çš„ json.Unmarshal(data []byte, v any) errorï¼Œjson.Unmarshal è¦æ±‚ä¼ å…¥ JSON ç¼–ç çš„æ•°æ®æºå’Œæ¥æ”¶å˜é‡çš„æŒ‡é’ˆï¼Œååºåˆ—åŒ–éœ€è¦ä¸¤ä¸ªæœ€åŸºæœ¬çš„æºï¼šæ•°æ®æºå’Œæ¥æ”¶æºã€‚å¦‚æœæ•°æ®æºæ˜¯ r io.Readerç±»å‹ï¼Œè¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨æ ‡å‡†åº“è£…å¥½çš„æ–¹æ³•ï¼š\ndec := json.NewDecoder(r) err := dec.Decode(point) ç¬”è€…æåŠ func (dec *Decoder) Decode(v any) error æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå›é¡¾ä¸€ä¸‹ day8 çš„ controller å±‚ä»£ç ï¼š\nfunc (c *user) Get(ctx *gin.Context) { var req *service.UserGetReq err := ctx.ShouldBindUri(\u0026amp;req) ... } å¾ˆæ˜æ˜¾æ¥æ”¶æºæ˜¯ var req *service.UserGetReqï¼Œè€Œ ctx.ShouldBindUri(\u0026amp;req) ä¸ dec.Decode(point) é«˜åº¦ç›¸ä¼¼ï¼Œç”šè‡³å‡½æ•°ç±»å‹éƒ½æ˜¯ï¼šfunc(point any) errorã€‚åˆ†æä¸€ä¸‹ï¼Œå¯¹äº *json.Decoder å’Œ *gin.Context æ¥è¯´ï¼Œæ•°æ®æºéƒ½è¢«éšè—åœ¨ç»“æ„ä½“å†…éƒ¨äº†ï¼ŒçœŸæ­£å…³é”®çš„ï¼Œæ˜¯ååºåˆ—åŒ–çš„å…¥å£å‡½æ•°ï¼šShouldBindUri å’Œ Decodeï¼Œå› æ­¤æ˜¯å¯ä»¥å°† ctx *gin.Context æ›¿æ¢ä¸º decode func(point any) error çš„ï¼Œå¤–éƒ¨ä¼ å…¥è¿™ä¸ªé—­åŒ…ï¼Œcontroller å±‚è°ƒç”¨é—­åŒ…ï¼Œå®Œæˆååºåˆ—åŒ–ã€‚ä¿®æ”¹ä¹‹åçš„å‡½æ•°ç­¾åï¼š\nfunc (c *user) Get( ctx context.Context, // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šctx decode func(point any) (err error), // ç¬¬äºŒä¸ªå‚æ•°ï¼šç”¨äºååºåˆ—åŒ–çš„é—­åŒ… ) ( data any, // è¿”å›çš„æ•°æ® err error, // é”™è¯¯å¤„ç† ){ var req service.UserGetReq err = decode( \u0026amp;req) // é€šè¿‡é—­åŒ…ååºåˆ—åŒ– req if err != nil { return nil, err } res, err := service.User.Get(ctx, req) if err != nil { return nil, err } return res, nil } ç»è¿‡æ”¹åŠ¨çš„ controller å’Œ webæ¡†æ¶å½»åº•è§£è€¦äº†ï¼Œå®Œå…¨çœ‹ä¸åˆ° Gin æ¡†æ¶çš„ä»£ç ï¼Œæ¯•ç«Ÿååºåˆ—åŒ–çš„å·¥ä½œä¹Ÿå¹¶ä¸æ˜¯ controller çš„ä»»åŠ¡ï¼Œé”™è¯¯å¤„ç†å’Œæ•°æ®è¿”å›ä¹Ÿå˜å¾—éå¸¸ç®€å•ï¼Œåªéœ€è¦æŠ›ç»™ä¸Šå±‚å¤„ç†ï¼ˆè¦ä¹ˆ return nil, errï¼Œè¦ä¹ˆ return res, nilï¼‰ï¼Œè§£è€¦ä¹‹åä¹Ÿä¸º controller å±‚å…¼å®¹å¤šç§åè®®å¸¦æ¥äº†å¯èƒ½ã€‚\nä¸è¿‡ä½†ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ ·çš„å‡½æ•°ï¼Œè¯¥å¦‚ä½•æ³¨å†Œåˆ° Ginæ¡†æ¶é‡Œå‘¢ï¼Ÿ\nç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ•°æ®è¿”å› All problems in computer science can be solved by another level of indirection.\nè®¡ç®—æœºç§‘å­¦é¢†åŸŸçš„ä»»ä½•é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªé—´æ¥çš„ä¸­é—´å±‚æ¥è§£å†³ã€‚\né˜è¿°è¿™éƒ¨åˆ†å†…å®¹ä¹‹å‰ï¼Œç¬”è€…æƒ³ç®€å•çš„ä»‹ç»ä¸€ä¸‹ã€Œè®¾è®¡æ¨¡å¼ã€é‡Œçš„ã€Œé€‚é…å™¨æ¨¡å¼ã€1ï¼š\nç®€å•æ¥è®²ï¼Œå°±æ˜¯é€šè¿‡æ¥å£è½¬æ¢ï¼Œè®©ä¸¤ä¸ªä¸å…¼å®¹çš„æ¥å£ï¼Œèƒ½å¤Ÿä¸€èµ·å·¥ä½œï¼Œç°å®ä¸­çš„ç»å…¸ä¾‹å­ï¼š å’Œä¸Šé¢çš„å›¾ç‰‡ç±»ä¼¼ï¼Œä¿®æ”¹åçš„å‡½æ•°ç±»å‹å·²ç»å’Œæ¡†æ¶è¦æ±‚çš„ gin.HandlerFunc æˆªç„¶ä¸åŒï¼Œä½†å€Ÿé‰´é€‚é…å™¨æ¨¡å¼çš„æ€æƒ³ï¼Œé€šè¿‡ä¸­é—´å‡½æ•°è½¬åŒ–ï¼Œå°±å¯ä»¥äº†ï¼š\n// ./handle/handle.go // è®¾ç½®ä¸ºç±»å‹ï¼Œç”¨äºä¼˜åŒ–å‚æ•°æ˜¾ç¤º type DecodeFunc = func( ctx context.Context, // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šctx decode func(point any) (err error), // ç¬¬äºŒä¸ªå‚æ•°ï¼šç”¨äºååºåˆ—åŒ–çš„é—­åŒ… ) ( data any, // è¿”å›çš„æ•°æ® err error, // é”™è¯¯å¤„ç† ) func Handle(decode DecodeFunc) gin.HandlerFunc { return func(c *gin.Context) { data, err := decode(c, func(point any) (err error) { // å®ç°ååºåˆ—åŒ– return c.ShouldBind(point) }) if err != nil { c.JSON(http.StatusOK, Response{Code: 400, Msg: err.Error(), Data: nil}) return } c.JSON(http.StatusOK, Response{200, \u0026#34;\u0026#34;, data}) } } æ–°çš„å‡½æ•°ä½œä¸ºã€Œé€‚é…å™¨ã€ï¼Œä¹Ÿä¼šè¢«å…¶ä»–è·¯ç”±è°ƒç”¨ï¼Œä¹Ÿä¸æ˜¯ä¸šåŠ¡ç›¸å…³çš„å†…å®¹ï¼Œä¸é€‚åˆæ”¾åˆ° internal åŒ…ï¼Œåº”å½“æ”¾åˆ°æ–°çš„åŒ…ï¼ˆæ–‡ä»¶å¤¹ï¼‰é‡Œï¼Œç¬”è€…å°†ä¹‹ä¿å­˜è‡³ /handle/handle.goã€‚\nç›¸åº”åœ°ï¼Œè·¯ç”±æ³¨å†Œä¹Ÿæœ‰äº›å˜åŒ–ï¼š\nfunc main() { r := gin.Default() { user := r.Group(\u0026#34;/user\u0026#34;) user.GET(\u0026#34;/\u0026#34;, handle.Handle(controller.User.Get)) user.POST(\u0026#34;/\u0026#34;, handle.Handle(controller.User.Add)) } r.Run() // listen and serve on 0.0.0.0:8080 (for windows \u0026#34;localhost:8080\u0026#34;) } å¯¹æ¯” day8 çš„æ³¨å†Œæ¨¡å¼ï¼š\nuser.GET(\u0026#34;/\u0026#34;, controller.User.Get) // å‡½æ•°ç­¾åï¼šfunc (c *user) Get(ctx *gin.Context) user.POST(\u0026#34;/\u0026#34;, controller.User.Add) // å‡½æ•°ç­¾åï¼šfunc (c *user) Add(ctx *gin.Context) è™½ç„¶æ³¨å†Œè·¯ç”±æ—¶ï¼Œå¿…é¡»å¾—å€Ÿç”¨ handle.Handle æ‰èƒ½è½¬åŒ–ä¸º gin.HandlerFuncï¼Œä½†æ˜¯å¯ä»¥ä¸ç”¨åœ¨ controller å±‚é‡Œå†™ï¼š\nc.JSON(http.StatusOK, Response{Code: 400, Msg: err.Error(), Data: nil}) c.JSON(http.StatusOK, Response{200, \u0026#34;\u0026#34;, data}) è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†é”™è¯¯å¤„ç†å’Œæ•°æ®è¿”å›çš„ç»Ÿä¸€ã€‚\nå°ç»“ æœ¬ç« èŠ‚ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š\ncontroller å±‚é€šè¿‡ä¼ å…¥ decode é—­åŒ…ï¼Œè°ƒç”¨é—­åŒ…å®ç°ååºåˆ—åŒ–å‡º service å±‚æ‰€éœ€æ•°æ®ï¼Œä¹Ÿå®Œæˆäº† controller ä¸æ¡†æ¶çš„è§£è€¦ï¼Œæ—¥åå¯ä»¥å…¼å®¹å…¶ä»–æ¡†æ¶ï¼ˆå¦‚ echoï¼‰å’Œå…¶ä»–åè®®ï¼ˆå¦‚ rpcï¼‰ã€‚ å€Ÿé‰´é€‚é…å™¨æ¨¡å¼ï¼Œå°† DecodeFunc å‡½æ•°è½¬åŒ–ä¸ºæ¡†æ¶æ‰€éœ€è¦çš„ç±»å‹ï¼Œå¹¶å®ç°é”™è¯¯å¤„ç†å’Œæ•°æ®è¿”å›çš„ç»Ÿä¸€ã€‚ è¿è¡Œç»“æœä¹Ÿæ²¡æœ‰å˜åŒ–ï¼š\nfunc client() { time.Sleep(time.Second) // ç­‰å¾…è·¯ç”±æ³¨å†Œ reqs := []func(host string) (*http.Response, error){ func(host string) (*http.Response, error) { return http.Get(host + \u0026#34;/user?name=Carol\u0026#34;) }, func(host string) (*http.Response, error) { return http.Get(host + \u0026#34;/user?name=Bob\u0026#34;) }, func(host string) (*http.Response, error) { return http.Post(host+\u0026#34;/user\u0026#34;, \u0026#34;application/json\u0026#34;, bytes.NewBufferString(`{\u0026#34;name\u0026#34;:\u0026#34;Carol\u0026#34;,\u0026#34;age\u0026#34;:44,\u0026#34;job\u0026#34;:\u0026#34;worker\u0026#34;}`)) }, func(host string) (*http.Response, error) { return http.Get(host + \u0026#34;/user?name=Carol\u0026#34;) }, } for _, req := range reqs { resp, err := req(\u0026#34;http://localhost:8080\u0026#34;) if err != nil { fmt.Println(\u0026#34;req err\u0026#34;, err) } data, err := io.ReadAll(resp.Body) if err != nil { fmt.Println(\u0026#34;read resp.Body err\u0026#34;, err) } fmt.Println(string(data)) } // Output: // // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:null} // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;name\u0026#34;:\u0026#34;Bob\u0026#34;,\u0026#34;age\u0026#34;:30,\u0026#34;job\u0026#34;:\u0026#34;driver\u0026#34;}} // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:null} // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;name\u0026#34;:\u0026#34;Carol\u0026#34;,\u0026#34;age\u0026#34;:44,\u0026#34;job\u0026#34;:\u0026#34;worker\u0026#34;}} } é€‚é…å™¨æ¨¡å¼\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2023-12-21T18:15:11+08:00","permalink":"https://niluan304.github.io/p/gee-web-day9-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E8%A7%A3%E8%80%A6/","title":"gee-web-day9 ååºåˆ—åŒ–ä¸è§£è€¦"},{"content":" æºä»£ç /æ•°æ®é›†å·²ä¸Šä¼ åˆ°ï¼šGitHub - follow gee to learn go\nä»€ä¹ˆæ˜¯è¯·æ±‚åˆ†å±‚æµè½¬ åœ¨é˜è¿°ä¸ºä»€ä¹ˆéœ€è¦åˆ†å±‚è®¾è®¡ä¹‹å‰ï¼Œç¬”è€…æƒ³å…ˆä»‹ç»ä¸€ä¸‹åˆ†å±‚æµè½¬1ï¼š\nåˆ†å±‚ä¹‹åï¼Œå¯ä»¥è®©æ¯ä¸€å±‚çš„ä¸“æ³¨äºä¸€ç±»äº‹ï¼Œè¿™ç±»ä¼¼äºè®¾è®¡æ¨¡å¼é‡Œå•ä¸€èŒè´£çš„æ€æƒ³ï¼Œå¯ä»¥æé«˜é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ï¼Œä¸æ¥å£çš„å¯å¤ç”¨æ€§ï¼Œä»è€Œå®ç°ä½è€¦åˆé«˜å†…èšã€‚è®¡ç®—æœºç½‘ç»œä¸­çš„ã€ŒTCP/IP å››å±‚æ¨¡å¼ã€å°±æ˜¯éå¸¸å…¸å‹çš„åˆ†å±‚ï¼Œå®ç°ä» HTTP åˆ° HTTPS çš„å‡çº§ï¼Œåªéœ€è¦åœ¨ HTTP åè®®ä¸ TCP ä¸­åŠ äº†ä¸€å±‚ TLSï¼Œå…¶ä»–å±‚çš„åè®®ä¸åº”ç”¨ä¸éœ€è¦åšä»»ä½•æ”¹åŠ¨ï¼Œè¿™å°±æ˜¯è®¡ç®—æœºç½‘ç»œæ¨¡å‹ä½è€¦åˆé«˜å†…èšçš„è¡¨ç°ã€‚\nä»£ç çº ç¼ çš„å›°å¢ƒ è¿™é‡Œæœ‰ä¸€ä»½ç®€å•çš„ CURD ä»£ç ï¼Œåªæœ‰ *user.Getã€*team.Get ä¸¤ä¸ªæ¥å£ï¼Œå’Œå¯¹åº”çš„æ•°æ®åº“è¡¨ UserTableã€TeamTableï¼ŒåŠŸèƒ½ä¹Ÿå¾ˆç®€å•ï¼Œæ ¹æ®è¡¨ä¸»é”®ï¼Œè·å–å¯¹åº”çš„è¡Œæ•°æ®ï¼š\n// ./internal/api.go type Response struct { Code int `json:\u0026#34;code\u0026#34;` // ä¸šåŠ¡ä»£ç ï¼Œ200 è¡¨ç¤º OKï¼Œå…¶ä»–è¡¨ç¤ºé”™è¯¯ Msg string `json:\u0026#34;msg\u0026#34;` // é”™è¯¯æ¶ˆæ¯ Data any `json:\u0026#34;data\u0026#34;` // è¿”å›çš„æ•°æ® } const ( CodeOK = 200 CodeBadRequest = 400 ) type user struct{} var User = \u0026amp;user{} func (c *user) Get(ctx *gin.Context) { var req *struct { Id int `uri:\u0026#34;id\u0026#34;` } err := ctx.ShouldBindUri(\u0026amp;req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } i := slices.IndexFunc(db.Users, func(row db.User) bool { return row.Id == req.Id }) if i == -1 { // æ•°æ®åº“æœªæ‰¾åˆ°æ•°æ® ctx.JSON(http.StatusOK, Response{CodeBadRequest, fmt.Sprintf(\u0026#34;user not found: %d\u0026#34;, req.Id), nil}) return } // è¿”å›æ•°æ®åº“å†…å®¹ row := db.Users[i] // Users åªæ˜¯ä¸€ä¸ªåˆ‡ç‰‡ []Userï¼Œç”¨äºå……å½“æ•°æ®åº“è¡¨ ctx.JSON(http.StatusOK, Response{CodeOK, \u0026#34;\u0026#34;, row}) return } type team struct{} var Team = \u0026amp;team{} func (c *team) Get(ctx *gin.Context) { var req *struct { Id int `uri:\u0026#34;id\u0026#34;` } err := ctx.ShouldBindUri(\u0026amp;req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } // æŸ¥è¯¢æ•°æ® i := slices.IndexFunc(db.Teams, func(row db.Team) bool { return row.Id == req.Id }) if i == -1 { // æ•°æ®åº“æœªæ‰¾åˆ°æ•°æ® ctx.JSON(http.StatusOK, Response{CodeBadRequest, fmt.Sprintf(\u0026#34;team not found: %d\u0026#34;, req.Id), nil}) return } // è¿”å›æ•°æ®åº“å†…å®¹ row := db.Teams[i] // Teams åªæ˜¯ä¸€ä¸ªåˆ‡ç‰‡ []Teamï¼Œç”¨äºå……å½“æ•°æ®åº“è¡¨ ctx.JSON(http.StatusOK, Response{CodeOK, \u0026#34;\u0026#34;, row}) return } ä»£ç å¾ˆç®€å•ï¼Œæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†å‡å¦‚éšç€é¡¹ç›®çš„è¿›å±•ï¼Œéœ€è¦æ–°å¢ä¸€ä¸ªæ¥å£ï¼šé€šè¿‡ userId è·å–ç”¨æˆ·ä¿¡æ¯å’Œç”¨æˆ·æ‰€åœ¨ Team çš„ä¿¡æ¯ã€‚\nè¿”å›çš„æ•°æ®æ ¼å¼ï¼š\ntype UserWithTeam struct { Id int `json:\u0026#34;id\u0026#34;` Name string `json:\u0026#34;name\u0026#34;` Team struct { Id int `json:\u0026#34;id\u0026#34;` Name string `json:\u0026#34;name\u0026#34;` } `json:\u0026#34;team\u0026#34;` } è¿™æ—¶å€™ç†æƒ³çš„å¤„ç†åŠæ³•ï¼š\næ ¹æ® userId é€šè¿‡ *user.Get è·å–åˆ°ç”¨æˆ·ä¿¡æ¯å’Œ teamId æ ¹æ® teamId é€šè¿‡ *team.Get è·å–ç”¨æˆ·æ‰€åœ¨ Team çš„ä¿¡æ¯ æµç¨‹çœ‹èµ·æ¥åªéœ€è¦å¤ç”¨å…ˆç”¨çš„æ¥å£ï¼Œå°±å¯ä»¥å®ç°éœ€æ±‚äº†ï¼Œæ¯”å¦‚è¿™æ ·ï¼š\nfunc (c *user) GetWithTeam(ctx *gin.Context) { c.Get(ctx) Team.Get(ctx) } å¦‚æœä»…ä»…æ˜¯è¿™æ ·çš„æ‰§è¡Œé¡ºåºï¼Œå¾ˆæ˜æ˜¾æ˜¯é”™è¯¯çš„ï¼Œç”¨æˆ·ç«¯é€šè¿‡è·¯ç”±ä¼šå¾—åˆ°\u0026quot;ç²˜åŒ…çš„ json\u0026quot;ï¼š\n{ \u0026#34;code\u0026#34;: 200, \u0026#34;msg\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;data\u0026#34;: { \u0026#34;Id\u0026#34;: 1, \u0026#34;Name\u0026#34;: \u0026#34;Alice\u0026#34;, \u0026#34;TeamId\u0026#34;: 1 } }{ \u0026#34;code\u0026#34;: 400, \u0026#34;msg\u0026#34;: \u0026#34;team not found: 1\u0026#34;, \u0026#34;data\u0026#34;: null } åˆ†æä¸€ä¸‹åŸå› ï¼Œ\né¦–å…ˆ *gin.Context é€šè¿‡è·¯ç”±æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œåªæœ‰ userId è¿™ä¸ªæ•°æ®ï¼Œå¹¶ä¸åŒ…å« teamIdï¼Œè€Œéœ€è¦çš„ teamId åœ¨ *user.Get æ¥å£å†…éƒ¨ç›´æ¥å†™åˆ°äº† (*gin.Context).JSON ä¸­ã€‚ å³ä¾¿æœ‰åŠæ³•è·å–ä¼ å…¥ (*gin.Context).JSON çš„æ•°æ®ï¼Œè¿˜éœ€è¦æ”¹é€  *gin.Contextï¼Œè®© *team.Get ä¹Ÿèƒ½è·å–åˆ°æ­£ç¡®çš„ teamIdï¼Œä½†æ˜¯ä¿®æ”¹ *gin.Context å†…éƒ¨æ•°æ®æ˜¯å¾ˆå±é™©çš„ä¸€ä»¶äº‹ï¼Œç¨æœ‰ä¸æ…ï¼Œå°±å¯èƒ½è·Œè½æ‚¬å´–ã€‚ å¦‚æœ *user.Get å’Œ *team.Get çš„è®¾è®¡æ˜¯ä¼ å…¥ idï¼Œè¿”å›å¯¹åº”ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥è½»æ¾å®ç°æ–°æ¥å£ï¼Œè¿˜èƒ½è§„é¿ä¿®æ”¹ *gin.Contextï¼Œæ¯”å¦‚è¿™æ ·ï¼š\nfunc GetWithTeam(ctx *gin.Context) { user := User.Get(id) team := Team.Get(user.TeamId) // ç»„è£…æ•°æ®ï¼Œå†™å…¥è¿”å› // ... } è¿™å…¶å®å°±è¿ç”¨åˆ°è®¡ç®—æœºç½‘ç»œæ¨¡å‹é‡Œç»å…¸çš„åˆ†å±‚æ€æƒ³ï¼Œå°†å…±åŒå±æ€§çš„åˆ†åˆ°åŒä¸€å±‚ï¼Œé€šè¿‡ä¸Šä¸‹å±‚çš„ã€Œå°åŒ…ã€å’Œã€Œè§£åŒ…ã€å®ç°è§£è€¦ã€‚ç°åœ¨æ¯”è¾ƒæµè¡Œçš„çº¯åç«¯ API æ¨¡å—ä¸€èˆ¬é‡‡ç”¨ä¸‹è¿°åˆ’åˆ†æ–¹æ³•2\nControllerï¼Œä¸ä¸Šè¿°ç±»ä¼¼ï¼ŒæœåŠ¡å…¥å£ï¼Œè´Ÿè´£å¤„ç†è·¯ç”±ï¼Œå‚æ•°æ ¡éªŒï¼Œè¯·æ±‚è½¬å‘ã€‚ Logic/Serviceï¼Œé€»è¾‘ï¼ˆæœåŠ¡ï¼‰å±‚ï¼Œä¸€èˆ¬æ˜¯ä¸šåŠ¡é€»è¾‘çš„å…¥å£ï¼Œå¯ä»¥è®¤ä¸ºä»è¿™é‡Œå¼€å§‹ï¼Œæ‰€æœ‰çš„è¯·æ±‚å‚æ•°ä¸€å®šæ˜¯åˆæ³•çš„ã€‚ä¸šåŠ¡é€»è¾‘å’Œä¸šåŠ¡æµç¨‹ä¹Ÿéƒ½åœ¨è¿™ä¸€å±‚ä¸­ã€‚å¸¸è§çš„è®¾è®¡ä¸­ä¼šå°†è¯¥å±‚ç§°ä¸º Business Rulesã€‚ DAO/Repositoryï¼Œè¿™ä¸€å±‚ä¸»è¦è´Ÿè´£å’Œæ•°æ®ã€å­˜å‚¨æ‰“äº¤é“ã€‚å°†ä¸‹å±‚å­˜å‚¨ä»¥æ›´ç®€å•çš„å‡½æ•°ã€æ¥å£å½¢å¼æš´éœ²ç»™ Logic å±‚æ¥ä½¿ç”¨ã€‚è´Ÿè´£æ•°æ®çš„æŒä¹…åŒ–å·¥ä½œã€‚ åˆ†å±‚è®¾è®¡ å…ˆä»‹ç»ä¸‹åˆ†å±‚åçš„ç›®å½•ç»“æ„ï¼š\n. |-- go.mod |-- go.sum |-- internal | |-- controller | | `-- controller.go | `-- service | |-- service.go | `-- service_model.go `-- main.go å½“ä¸šåŠ¡ä»£ç éƒ½æ”¾åˆ°äº† service å±‚æ—¶ï¼Œè¿™ä¸€å±‚çš„ä»£ç äº’ç›¸è°ƒç”¨æ˜¯ä¸ä¼šè¢« controller å±‚å½±å“çš„ï¼Œè¿™ä¹Ÿå®ç°äº† Gin æ¡†æ¶ä¸ä¸šåŠ¡ä»£ç çš„è§£è€¦ã€‚\ncontroller å±‚çš„ä¸»è¦ä»£ç ï¼š\n// ./internal/controller/controller.go func (c *user) Get(ctx *gin.Context) { var req *service.UserGetReq err := ctx.ShouldBindUri(\u0026amp;req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } res, err := service.User.Get(ctx, req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } // å¡«å†™å“åº”å†…å®¹ ctx.JSON(http.StatusOK, Response{CodeOK, \u0026#34;\u0026#34;, res}) return } func (c *team) Get(ctx *gin.Context) { var req *service.TeamGetReq err := ctx.ShouldBindUri(\u0026amp;req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } res, err := service.Team.Get(ctx, req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } // å¡«å†™å“åº”å†…å®¹ ctx.JSON(http.StatusOK, Response{CodeOK, \u0026#34;\u0026#34;, res}) return } service å±‚çš„ä¸»è¦ä»£ç ï¼š\n// ./internal/service/service.go func (s *user) Get(ctx context.Context, req *UserGetReq) (res *UserGetRes, err error) { // æŸ¥è¯¢æ•°æ® i := slices.IndexFunc(db.Users, func(row db.User) bool { return row.Id == req.Id }) if i == -1 { // æ•°æ®åº“æœªæ‰¾åˆ°æ•°æ® return nil, fmt.Errorf(\u0026#34;user not found: %d\u0026#34;, req.Id) } // è¿”å›æ•°æ®åº“å†…å®¹ row := db.Users[i] // Users åªæ˜¯ä¸€ä¸ªåˆ‡ç‰‡ []Userï¼Œç”¨äºå……å½“æ•°æ®åº“è¡¨ return \u0026amp;UserGetRes{Id: row.Id, Name: row.Name, TeamId: row.TeamId}, nil } func (s *team) Get(ctx context.Context, req *TeamGetReq) (res *TeamGetRes, err error) { // æŸ¥è¯¢æ•°æ® i := slices.IndexFunc(db.Teams, func(row db.Team) bool { return row.Id == req.Id }) if i == -1 { // æ•°æ®åº“æœªæ‰¾åˆ°æ•°æ® return nil, fmt.Errorf(\u0026#34;team not found: %d\u0026#34;, req.Id) } // è¿”å›æ•°æ®åº“å†…å®¹ row := db.Teams[i] // Teams åªæ˜¯ä¸€ä¸ªåˆ‡ç‰‡ []Teamï¼Œç”¨äºå……å½“æ•°æ®åº“è¡¨ return \u0026amp;TeamGetRes{Id: row.Id, Name: row.Name}, nil } è¿™æ—¶å€™ï¼Œå†æ¥å®ç°ä¸€ä¸‹ï¼Œæ–°å¢ä¸€ä¸ªæ¥å£ï¼šé€šè¿‡ userId è·å–ç”¨æˆ·ä¿¡æ¯å’Œç”¨æˆ·æ‰€åœ¨ Team çš„ä¿¡æ¯ã€‚\nfunc (c *user) GetWithTeam(ctx *gin.Context) { var req *service.UserGetReq err := ctx.ShouldBindUri(\u0026amp;req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } userRes, err := service.User.Get(ctx, req) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } teamRes, err := service.Team.Get(ctx, \u0026amp;service.TeamGetReq{Id: userRes.TeamId}) if err != nil { ctx.JSON(http.StatusOK, Response{CodeBadRequest, err.Error(), nil}) return } type UserWithTeam struct { Id int `json:\u0026#34;id\u0026#34;` Name string `json:\u0026#34;name\u0026#34;` Team service.TeamGetRes `json:\u0026#34;team\u0026#34;` } // å¡«å†™å“åº”å†…å®¹ ctx.JSON(http.StatusOK, Response{CodeOK, \u0026#34;\u0026#34;, UserWithTeam{ Id: userRes.Id, Name: userRes.Name, Team: *teamRes, }}) return } åˆ†å±‚åçš„æ€»ä»£ç è¡Œæ•°æœ‰æ‰€å¢åŠ ï¼Œæ•´ä¸ªé¡¹ç›®çš„å¸ƒå±€å˜å¾—æ›´æ¸…æ™°äº†ï¼Œä¸šåŠ¡ä»£ç ä¹Ÿä¸ä¼šå—åˆ° webæ¡†æ¶çš„å¹²æ‰°ï¼Œå¯ä»¥é›†ä¸­å¤„ç†ä¸šåŠ¡ã€‚è€Œä¸”ä¸šåŠ¡å±‚çš„å‡½æ•°ç­¾åå…·æœ‰å¯è¯»æ€§äº†ï¼Œè°ƒç”¨ service å±‚çš„æ–¹æ³•æ—¶ï¼Œå°±å¯ä»¥çŸ¥é“æ‰€éœ€è¦çš„å‚æ•°ï¼Œä»¥åŠè¿”å›çš„å€¼ã€‚ä¸è¿‡æœ‰äº›è¯»è€…å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆ service å±‚æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯ ctx context.Contextï¼Œå³ä¾¿ä»£ç ä¸­æœªå¿…ä½¿ç”¨ï¼Œè¿™ç®—æ˜¯ go è¯­è¨€åœ¨ web å¼€å‘ä¸­çš„ç‰¹è‰²ï¼ˆä¹Ÿå¯èƒ½æ˜¯æŠ€æœ¯å€ºï¼‰ï¼Œç”¨äºå¹¶å‘æ§åˆ¶å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’çš„ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œäº†è§£ä¸‹ã€‚\nä½†æ˜¯åœ¨ controller å±‚æœ‰å¤ªå¤šçš„ (*gin.Context).JSON()ï¼Œä¹Ÿå°±æ˜¯å¤„ç†æ¥å£çš„å“åº”ï¼Œå˜å¾—å¼‚å¸¸ç¹çï¼Œä¸ºäº†è§£å†³è¿™ä¸€ç‚¹ï¼Œç¬”è€…å°†åœ¨ä¸‹ä¸€èŠ‚é˜è¿°å¦‚ä½•åœ¨æ¡†æ¶ä¸­å®ç°ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ•°æ®è¿”å›ã€‚\nå°ç»“ æœ¬ç« èŠ‚ä»‹ç»ä¸‹å¦‚ä½•é€šè¿‡ã€Œåˆ†å±‚è®¾è®¡ã€å°†ä¸€ä¸ªå¤§é—®é¢˜ï¼Œè½¬åŒ–ä¸ºè‹¥å¹²çš„åˆ†å·¥æ˜ç¡®çš„å°é—®é¢˜ï¼Œå®ç°ä¸šåŠ¡ä»£ç ä¸ webæ¡†æ¶è§£è€¦ï¼Œæé«˜ç³»ç»Ÿçš„æ‹“å±•æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä»è€Œå®ç°é«˜å†…èšä½è€¦åˆã€‚\næ³¨æ„ï¼šåˆ†å±‚è®¾è®¡ä¹Ÿä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼šæ–°å¢ä¸€ä¸ªä¸šåŠ¡æ¥å£æ—¶ï¼Œéœ€è¦æ”¹åŠ¨çš„æ–‡ä»¶ä¹Ÿä¼šå˜å¤šï¼Œä¸è¿‡è¿™å¯ä»¥é€šè¿‡è„šæœ¬ç”Ÿæˆä»£ç ç¼“è§£ã€‚ æœ€åè®©æˆ‘ä»¬æ¥çœ‹çœ‹ç¨‹åºçš„è¿è¡Œç»“æœï¼š\nfunc client() { time.Sleep(time.Second) // ç­‰å¾…è·¯ç”±æ³¨å†Œ reqs := []func(host string) (*http.Response, error){ func(host string) (*http.Response, error) { return http.Get(host + \u0026#34;/user?name=Carol\u0026#34;) }, func(host string) (*http.Response, error) { return http.Get(host + \u0026#34;/user?name=Bob\u0026#34;) }, func(host string) (*http.Response, error) { return http.Post(host+\u0026#34;/user\u0026#34;, \u0026#34;application/json\u0026#34;, bytes.NewBufferString(`{\u0026#34;name\u0026#34;:\u0026#34;Carol\u0026#34;,\u0026#34;age\u0026#34;:44,\u0026#34;job\u0026#34;:\u0026#34;worker\u0026#34;}`)) }, func(host string) (*http.Response, error) { return http.Get(host + \u0026#34;/user?name=Carol\u0026#34;) }, } for _, req := range reqs { resp, err := req(\u0026#34;http://localhost:8080\u0026#34;) if err != nil { fmt.Println(\u0026#34;req err\u0026#34;, err) } data, err := io.ReadAll(resp.Body) if err != nil { fmt.Println(\u0026#34;read resp.Body err\u0026#34;, err) } fmt.Println(string(data)) } // Output: // // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:null} // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;name\u0026#34;:\u0026#34;Bob\u0026#34;,\u0026#34;age\u0026#34;:30,\u0026#34;job\u0026#34;:\u0026#34;driver\u0026#34;}} // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:null} // {\u0026#34;code\u0026#34;:200,\u0026#34;msg\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;name\u0026#34;:\u0026#34;Carol\u0026#34;,\u0026#34;age\u0026#34;:44,\u0026#34;job\u0026#34;:\u0026#34;worker\u0026#34;}} } å·¥ç¨‹ç›®å½•è®¾è®¡ğŸ”¥ - GoFrame (ZH)\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nå¤§å‹Webé¡¹ç›®åˆ†å±‚ - Goè¯­è¨€é«˜çº§ç¼–ç¨‹ï¼š\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2023-12-20T13:49:08+08:00","permalink":"https://niluan304.github.io/p/gee-web-day8-%E5%88%86%E5%B1%82%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7/","title":"gee-web-day8 åˆ†å±‚è®¾è®¡çš„å¿…è¦æ€§"},{"content":"è·Ÿç€è¿™ç¯‡æ•™ç¨‹ 7å¤©ç”¨Goä»é›¶å®ç°Webæ¡†æ¶Geeæ•™ç¨‹ | æå®¢å…”å…”ï¼Œç¬”è€…å®ç°äº†ä¸€ä¸ªç®€å•çš„ webæ¡†æ¶ï¼Œä»è€Œæ˜ç™½äº† webæ¡†æ¶æ‰€éœ€è¦çš„ç‰¹æ€§ï¼Œè¿˜è¿¸å‘å‡ºå°è£… Gin çš„æƒ³æ³•ã€‚\nwebæ¡†æ¶ æ‰€éœ€è¦çš„ç‰¹æ€§ åˆ†ç»„æ§åˆ¶ åˆ†ç»„æ§åˆ¶ (Group Control)æ˜¯ Web æ¡†æ¶åº”å½“æä¾›çš„åŸºç¡€åŠŸèƒ½ï¼Œæœ‰äº†åˆ†ç»„ä¸åˆ†ç»„åµŒå¥—ï¼Œç³»ç»Ÿæ‰å¯ä»¥æ›´æ–¹ä¾¿çš„ç®¡ç†ä¸åŒçš„ä¸šåŠ¡ï¼Œæ­é…ä¸­é—´ä»¶ï¼Œå°±å¯ä»¥å¤„ç†åŒç»„ä¸‹çš„å…¬å…±é€»è¾‘ã€‚\nä¸­é—´ä»¶ ä¸­é—´ä»¶ (Middleware)æ˜¯ web æ¡†æ¶çš„çµé­‚ï¼Œä¸º web æ¡†æ¶æä¾›æ— é™çš„æ‰©å±•èƒ½åŠ›ã€‚æœ‰äº†ä¸­é—´ä»¶ï¼Œå¯ä»¥åªå¯¹ admin å’Œ api åˆ†ç»„è¿›è¡Œé‰´æƒï¼Œå¯¹ç‰¹å®šæ¥å£é™æµã€‚\nå¯¹æœ€é¡¶å±‚ç›®å½• \u0026ldquo;/\u0026quot;ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªç³»ç»Ÿï¼Œå¯ä»¥é…ç½®æ—¥å¿—ï¼Œè¯·æ±‚è€—æ—¶ç­‰åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥è®¾ç½®æœ€å°ç²’åº¦çš„ä¸­é—´ä»¶ â€”â€”â€”â€” ä¸ºä¸šåŠ¡ä»£ç ç»‘å®šå…·ä½“çš„è·¯ç”±ï¼ˆè·¯ç”±æ³¨å†Œå…¶å®å°±æ˜¯è®¾ç½®ä½œç”¨åŸŸåªæœ‰è·¯ç”±çš„ä¸­é—´ä»¶ï¼‰ã€‚\nåŠ¨æ€è·¯ç”± åŠ¨æ€è·¯ç”± (Dynamic Route)ï¼Œæœ¬è´¨ä¸Šåªæ˜¯å°†å‚æ•°ç»™æ˜ å°„ä¸ºè·¯å¾„çš„ä¸€éƒ¨åˆ†äº†ï¼Œæ¯”å¦‚ https://github.com/niluan304 å’Œ https://github.com/?user=niluan304 å¯¹äºåç«¯æ¥è®²å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚ä¸è¿‡åŠ¨æ€è·¯ç”±è¿˜æ˜¯æœ‰ä¼˜åŠ¿çš„ï¼š\næé«˜SEOï¼šæœç´¢å¼•æ“è§£æé™æ€URLæ›´ä¸ºè½»æ¾ï¼ŒåŠ¨æ€è·¯ç”±å°†å‚æ•°å†…åµŒè‡³URLä¸­ï¼Œå¯ä»¥æé«˜SEOæ•ˆæœã€‚ å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼šç°é˜¶æ®µçš„åŠ¨æ€è·¯ç”±å¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼Œå¦‚ /user/:name/article/:articleIdï¼Œå¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§æ˜æ˜¾é«˜äº user/article?name=zwei\u0026amp;?articleId=1234ã€‚ å¯æ‹“å±•æ€§ï¼šåŠ¨æ€è·¯ç”±å¯ä»¥ä½¿ç”¨å‰ç¼€è¿›è¡Œåˆ†ç»„ï¼Œè¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“æ·»åŠ å’Œä¿®æ”¹åŒä¸€åˆ†ç»„ä¸‹çš„ä¸­é—´ä»¶ã€‚ Gin ä¸ GoFrame çš„å·®å¼‚ å®ç°ç®€æ˜“webæ¡†æ¶ä¹‹åï¼Œæ‰ç®—ç†è§£ Gin çš„ä¸­é—´ä»¶ä¸ controller çš„æ ¼å¼ä¸ºä»€ä¹ˆå¿…é¡»ä¸ºï¼š\nfunc(c *gin .Context) { // ä¸­é—´ä»¶ æˆ– ä¸šåŠ¡ä»£ç é€»è¾‘ } è¿™å’Œç¬”è€…æœ€ç†Ÿæ‚‰çš„ GoFrame æ¡†æ¶æœ‰ä¸€äº›å·®å¼‚ï¼ŒGoFrame çš„ controller è¿˜é¢å¤–æ”¯æŒå¦ä¸€ç§å†™æ³•ï¼š\n// ä¸­é—´ä»¶å¼å†™æ³•ï¼Œç±»ä¼¼ gin çš„ func(c *gin .Context) func (r *ghttp.Request) { // ä¸­é—´ä»¶ æˆ– ä¸šåŠ¡ä»£ç é€»è¾‘ } // å†™æ³•äºŒ func (ctx context.Context, req *{Prefix}Req) (res *{Prefix}Res, err error){ // ä¸šåŠ¡ä»£ç é€»è¾‘ } å¸¦ç€ç–‘é—®ï¼Œç¬”è€…æ¢ç©¶äº†ä¸¤ä¸ªæ¡†æ¶ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶å°è¯•å°† Gin çš„æ¥å£æ”¹é€ ä¸º GoFrame æ ¼å¼ã€‚ æ€»ç»“åå¯ä»¥æ¦‚æ‹¬ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œè¿™ç®—æ˜¯ã€Œ7å¤©æ•™ç¨‹ã€çš„è¯»åæ„Ÿï¼Œç¬”è€…ä¹Ÿä»¿ç…§å‘½åä¸ºï¼š\nday8 åˆ†å±‚è®¾è®¡çš„å¿…è¦æ€§ day9 ååºåˆ—åŒ–ä¸è§£è€¦ day10 é€šè¿‡åå°„æ„é€ è§„èŒƒè·¯ç”± ","date":"2023-12-19T11:27:57+08:00","permalink":"https://niluan304.github.io/p/gee-web-day7.5-7%E5%A4%A9-web%E6%A1%86%E6%9E%B6%E8%AF%BB%E5%90%8E%E6%84%9F/","title":"gee-web-day7.5 ã€Œ7å¤© webæ¡†æ¶ã€è¯»åæ„Ÿ"},{"content":"åœ¨å›½å†…æ‰§è¡Œ git clone https://github.com/golang/go.git æ“ä½œï¼Œåˆæ…¢åˆä¸ç¨³å®šï¼Œæœç´¢åå‘ç°å¯ä»¥ä½¿ç”¨ä»£ç†è¿™ä¸ªé—®é¢˜ã€‚\nå‡†å¤‡å·¥ä½œ é¦–å…ˆï¼Œä½ éœ€è¦å‡†å¤‡å¥½ä»£ç†å·¥å…·ï¼Œä¸€èˆ¬çš„ä»£ç†å·¥å…·éƒ½æœ‰ Sock5 å’Œ HTTP ä¸¤ç§ä»£ç†æ–¹å¼ã€‚\nå¸¸è§çš„ä»£ç†è½¯ä»¶ä½¿ç”¨çš„ç«¯å£æœ‰ï¼š7890, 1080ï¼Œä¸‹æ–‡çš„ {port} å‚æ•°éƒ½éœ€è¦ä¿®æ”¹ä¸ºå¯¹åº”çš„ç«¯å£å·ã€‚\nç¬”è€…ä¼šæŒ‰ç…§ Windows å’Œ ç±» Unix ç³»ç»Ÿä»‹ç»ä¸º git è®¾ç½®ä»£ç†çš„æ–¹æ³•ï¼Œç”±äºç›¸ä¼¼å¤„å¾ˆå¤šï¼Œè¯·æŒ‰éœ€æŸ¥çœ‹ã€‚\nWindows ä¸‹ ä¸º HTTP åè®®è®¾ç½®ä»£ç† åœ¨ GitHubä¸Šï¼Œé€šè¿‡ç¬¬ä¸€ç§æ–¹å¼å…‹éš†ä»“åº“ï¼Œè¿™é‡Œèµ°çš„å°±æ˜¯ HTTP åè®®ï¼Œä¿®æ”¹èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼š\nå‘½ä»¤è¡Œè®¾ç½® é€šè¿‡ä»£ç†è½¯ä»¶ HTTP çš„ç«¯å£ åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ git config --global https.https://github.com.proxy https://127.0.0.1:{port} é€šè¿‡ä»£ç†è½¯ä»¶ Sock5 çš„ç«¯å£ åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ git config --global https.https://github.com.proxy socks5://127.0.0.1:{port} å¯ä»¥å‘ç°ï¼Œä¸¤è€…çš„å‘½ä»¤æå…¶ç›¸ä¼¼ï¼Œæ ¼å¼éƒ½ä¸ºï¼š\ngit config --global https.https://github.com.proxy {protocol}://{ip}:{port} æ‰€ä»¥ï¼Œå‡­ä¸ªäººå–œå¥½ä½¿ç”¨å°±å¥½ã€‚\nå¦å¤–ï¼Œå¦‚æœä»£ç†è½¯ä»¶å¹¶ä¸åœ¨æœ¬åœ°è¿è¡Œï¼Œé‚£ä¹ˆå°±å°† 127.0.0.1 ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶æœåŠ¡å™¨çš„ ipï¼ˆéœ€è¦æœ‰è®¿é—®æƒé™ï¼‰ã€‚\nä¿®æ”¹ .gitconfig æ–‡ä»¶ å¦‚æœä¸å–œæ¬¢åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹ C:/Users/${your username}/.gitconfig æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\né€šè¿‡ä»£ç†è½¯ä»¶ HTTP çš„ç«¯å£ [https \u0026#34;https://github.com\u0026#34;] # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ proxy = https://127.0.0.1:{port} é€šè¿‡ä»£ç†è½¯ä»¶ Sock5 çš„ç«¯å£ [http \u0026#34;https://github.com\u0026#34;] # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ proxy = socks5://127.0.0.1:{port} å–æ¶ˆä»£ç† é€šè¿‡å‘½ä»¤è¡Œï¼š\ngit config --global --unset https.https://github.com.proxy ä¹Ÿå¯ä»¥ä¿®æ”¹ C:/Users/${your username}/.gitconfig æ–‡ä»¶ï¼Œåˆ é™¤æˆ–æ³¨é‡Š [https \u0026quot;https://github.com\u0026quot;] åŒºåŸŸçš„å†…å®¹ã€‚\nä¸º SSH åè®®è®¾ç½®ä»£ç† åœ¨ GitHubä¸Šï¼Œé€šè¿‡ç¬¬äºŒç§æ–¹å¼å…‹éš†ä»“åº“ï¼Œèµ°çš„å°±æ˜¯ SSH åè®®ï¼š\nä¿®æ”¹ .ssh/config æ–‡ä»¶ æ‰¾åˆ° ~/.ssh ç›®å½•ä¸‹çš„ config æ–‡ä»¶ï¼ˆå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆæ–°å»ºå³å¯ï¼‰ã€‚\né€šè¿‡ä»£ç†è½¯ä»¶ HTTP çš„ç«¯å£ config æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š Host github.com Hostname ssh.github.com # git åœ¨ window ä¸‹ä½¿ç”¨çš„ä»£ç†è½¯ä»¶ä¸º connect # -Hä¸ºHTTPåè®®ï¼Œ -SæŒ‡Socks 5åè®® # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ ProxyCommand connect -H 127.0.0.1:{port} %h %p # æœåŠ¡å¯¹åº”ç«¯å£ Port 443 é€šè¿‡ä»£ç†è½¯ä»¶ Sock5 çš„ç«¯å£ config æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š Host github.com Hostname ssh.github.com # git åœ¨ window ä¸‹ä½¿ç”¨çš„ä»£ç†è½¯ä»¶ä¸º connect # -Hä¸ºHTTPåè®®ï¼Œ -SæŒ‡Socks 5åè®® # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ ProxyCommand connect -S 127.0.0.1:{port} %h %p # æœåŠ¡å¯¹åº”ç«¯å£ Port 443 éªŒè¯ å…ˆæ‰“å¼€ git bash ï¼Œç„¶åæ‰§è¡Œï¼š\nssh -T git@github.com` ç»“æœç±»ä¼¼ï¼š\n$ ssh -T git@github.com Hi niluan304! You\u0026#39;ve successfully authenticated, but GitHub does not provide shell access. ç±» Unix ç³»ç»Ÿ ä¸º HTTP åè®®è®¾ç½®ä»£ç† åœ¨ GitHubä¸Šï¼Œé€šè¿‡ç¬¬ä¸€ç§æ–¹å¼å…‹éš†ä»“åº“ï¼Œè¿™é‡Œèµ°çš„å°±æ˜¯ HTTP åè®®ï¼Œä¿®æ”¹èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼š\nå‘½ä»¤è¡Œè®¾ç½® é€šè¿‡ä»£ç†è½¯ä»¶ HTTP çš„ç«¯å£ åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ git config --global https.https://github.com.proxy https://127.0.0.1:{port} é€šè¿‡ä»£ç†è½¯ä»¶ Sock5 çš„ç«¯å£ åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ git config --global https.https://github.com.proxy socks5://127.0.0.1:{port} å¯ä»¥å‘ç°ï¼Œä¸¤è€…çš„å‘½ä»¤æå…¶ç›¸ä¼¼ï¼Œæ ¼å¼éƒ½ä¸ºï¼š\ngit config --global https.https://github.com.proxy {protocol}://{ip}:{port} æ‰€ä»¥ï¼Œå‡­ä¸ªäººå–œå¥½ä½¿ç”¨å°±å¥½ã€‚\nå¦å¤–ï¼Œå¦‚æœä»£ç†è½¯ä»¶å¹¶ä¸åœ¨æœ¬åœ°è¿è¡Œï¼Œé‚£ä¹ˆå°±å°† 127.0.0.1 ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶æœåŠ¡å™¨çš„ ipï¼ˆéœ€è¦æœ‰è®¿é—®æƒé™ï¼‰ã€‚\nä¿®æ”¹ .gitconfig æ–‡ä»¶ å¦‚æœä¸å–œæ¬¢åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹ ~/.gitconfig æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\né€šè¿‡ä»£ç†è½¯ä»¶ HTTP çš„ç«¯å£ [https \u0026#34;https://github.com\u0026#34;] # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ proxy = https://127.0.0.1:{port} é€šè¿‡ä»£ç†è½¯ä»¶ Sock5 çš„ç«¯å£ [http \u0026#34;https://github.com\u0026#34;] # {port} ä¿®æ”¹ä¸ºä»£ç†è½¯ä»¶çš„ç«¯å£ proxy = socks5://127.0.0.1:{port} å–æ¶ˆä»£ç† é€šè¿‡å‘½ä»¤è¡Œï¼š\ngit config --global --unset https.https://github.com.proxy ä¹Ÿå¯ä»¥ä¿®æ”¹ ~/.gitconfig æ–‡ä»¶ï¼Œåˆ é™¤æˆ–æ³¨é‡Š [https \u0026quot;https://github.com\u0026quot;] åŒºåŸŸçš„å†…å®¹ã€‚\nä¸º SSH åè®®è®¾ç½®ä»£ç† åœ¨ GitHubä¸Šï¼Œé€šè¿‡ç¬¬äºŒç§æ–¹å¼å…‹éš†ä»“åº“ï¼Œèµ°çš„å°±æ˜¯ SSH åè®®ï¼š\nä¿®æ”¹ .ssh/config æ–‡ä»¶ æ‰¾åˆ° ~/.ssh ç›®å½•ä¸‹çš„ config æ–‡ä»¶ï¼ˆå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆæ–°å»ºå³å¯ï¼‰ã€‚\né€šè¿‡ä»£ç†è½¯ä»¶ HTTP çš„ç«¯å£ config æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š Host github.com Hostname ssh.github.com # git åœ¨ Linux å’Œ Mac ä¸‹ä½¿ç”¨çš„ä»£ç†è½¯ä»¶ä¸º netcatï¼Œç®€ç§°ncã€‚ # -X 5 æŒ‡ä»£ç†åè®®Socks 5ï¼Œ -X 4 æŒ‡ä»£ç†åè®®Socks 4ï¼Œ -X connectæŒ‡ä»£ç†åè®®Socks HTTP ProxyCommand nc -v -X 127.0.0.1:xxxx %h %p # æœåŠ¡å¯¹åº”ç«¯å£ Port 443 é€šè¿‡ä»£ç†è½¯ä»¶ Sock5 çš„ç«¯å£ config æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š Host github.com Hostname ssh.github.com # git åœ¨ Linux å’Œ Mac ä¸‹ä½¿ç”¨çš„ä»£ç†è½¯ä»¶ä¸º netcatï¼Œç®€ç§°ncã€‚ # -X 5 æŒ‡ä»£ç†åè®®Socks 5ï¼Œ -X 4 æŒ‡ä»£ç†åè®®Socks 4ï¼Œ -X connectæŒ‡ä»£ç†åè®®Socks HTTP ProxyCommand nc -v -X 5 127.0.0.1:xxxx %h %p # æœåŠ¡å¯¹åº”ç«¯å£ Port 443 éªŒè¯ å…ˆæ‰“å¼€ git bash ï¼Œç„¶åæ‰§è¡Œï¼š\nssh -T git@github.com ç»“æœç±»ä¼¼ï¼š\n$ ssh -T git@github.com Hi niluan304! You\u0026#39;ve successfully authenticated, but GitHub does not provide shell access. å¦‚æœé‡åˆ°é”™è¯¯ï¼Œå¯ä»¥åˆ é™¤ .ssh ç›®å½•ä¸­ known_hosts æ–‡ä»¶åé‡è¯•ã€‚\n","date":"2023-03-14T18:08:02+08:00","permalink":"https://niluan304.github.io/p/%E4%B8%BA-git-clone-github-%E8%AE%BE%E7%BD%AE-http-%E5%92%8C-ssh-%E4%BB%A3%E7%90%86/","title":"ä¸º git clone github è®¾ç½® HTTP å’Œ SSH ä»£ç†"},{"content":"ä½¿ç”¨ slices.Sort å’Œ slices.SortFunc é¿å… sort.Slices çš„å‘\nsort.Slices ä»‹ç» sort.Slices æ˜¯go äº1.18 ç‰ˆæœ¬æ–°å¢çš„æ’åºå‡½æ•°ï¼Œç­¾åå¦‚ä¸‹ï¼š\nfunc Slice(x any, less func(i, j int) bool) ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼š\nfunc main() { type Student struct { Name string Age int } students := []Student{ {Name: \u0026#34;Gopher\u0026#34;, Age: 14}, {Name: \u0026#34;Carol\u0026#34;, Age: 10}, {Name: \u0026#34;Alice\u0026#34;, Age: 10}, {Name: \u0026#34;Bob\u0026#34;, Age: 15}, {Name: \u0026#34;Dave\u0026#34;, Age: 12}, } // sort by Age first, Name second sort.Slice(students, func(i, j int) bool { x, y := students[i], students[j] if x.Age != y.Age { return x.Age \u0026lt; y.Age } return x.Name \u0026lt; y.Name }) for _, student := range students { fmt.Printf(\u0026#34;%d %s\\n\u0026#34;, student.Age, student.Name) } } // Output: // 10 Alice // 10 Carol // 12 Dave // 14 Gopher // 15 Bob é—­åŒ…çš„å‘ ä¸Šé¢çš„ä»£ç ä¸­ï¼Œç”šè‡³è¿›è¡Œäº†å¤šå­—æ®µæ’åºã€‚ä½†å¦‚æœæˆ‘ä»¬åªéœ€è¦éƒ¨åˆ†æ’åºï¼Œä»£ç åˆè¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿ\nè¿™æ ·å¯¹å—ï¼Ÿ\nfunc SortAfter(nums []int, p int) { // ä»på¼€å§‹æ’åº sort.Slice(nums[p:], func(i, j int) bool { return nums[i] \u0026lt; nums[j] }) } å’‹ä¸€çœ‹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œè·‘ä¸‹æµ‹è¯•ç”¨ä¾‹å§ï¼š\nfunc main() { nums := []int{2, 3, 1, 5, 4, 6, 7} tests := []struct { p int want []int }{ {p: 1, want: []int{2, 1, 3, 4, 5, 6, 7}}, {p: 2, want: []int{2, 3, 1, 4, 5, 6, 7}}, {p: 3, want: []int{2, 3, 1, 4, 5, 6, 7}}, } for _, tt := range tests { got := slices.Clone(nums) // æ‹·è´åŸå§‹æ•°æ®ï¼Œç”¨äºæµ‹è¯• SortAfter(got, tt.p) if !reflect.DeepEqual(got, tt.want) { fmt.Printf(\u0026#34;when p: %v ,want: %v, but got: %v\\n\u0026#34;, tt.p, tt.want, got) } } } // Output: // when p: 1 ,want: [2 1 3 4 5 6 7], but got: [2 3 5 6 7 4 1] // when p: 3 ,want: [2 3 1 4 5 6 7], but got: [2 3 1 5 6 4 7] ä¸ºä»€ä¹ˆ p = 1,3 æ—¶ä¸å¯¹ï¼Œp = 2 æ—¶åˆæ˜¯å¯¹çš„å‘¢ï¼Ÿ å› ä¸º sort.Slices æ¥æ”¶åˆ°çš„å‚æ•°æ˜¯ nums[p:]ï¼Œless é—­åŒ…é‡Œçš„å‚æ•° i, j æ˜¯åœ¨ nums[p:] çš„ä½ç½®ï¼Œå¦‚æœç›´æ¥æ¯”è¾ƒ nums[i] å’Œnums[j]ï¼Œé‚£å°±å¿½ç•¥äº† p åç§»çš„å½±å“ï¼Œæ‰€ä»¥å®é™…è¦æ¯”è¾ƒçš„å…ƒç´ å…¶å®æ˜¯ nums[i+p] å’Œ nums[j+p]ï¼Œé‚£ä¹ˆä¿®å¤åçš„å‡½æ•°ï¼š\nfunc SortAfter(nums []int, p int) { // ä»på¼€å§‹æ’åº sort.Slice(nums[p:], func(i, j int) bool { // è¿™é‡Œä¼ å…¥çš„sliceä¸å†æ˜¯å®Œæ•´çš„numsï¼Œè€Œæ˜¯nums[p:] return nums[i+p] \u0026lt; nums[j+p] }) } ä½¿ç”¨ slices.Sort ä¼˜åŒ– æ‰‹åŠ¨ä¿®æ­£åç§»é‡ï¼Œå¯ä»¥é¿å…éƒ¨åˆ†æ’åºè¿™ä¸ªå‘ä¸€æ—¶ï¼Œä½†æ—¥åä¾æ—§æœ‰å¯èƒ½å› ä¸ºæ€ç»´æƒ¯æ€§è€Œå¯¼è‡´å†æ¬¡è¸©å‘ã€‚å…·ä½“å®ç°ä¹Ÿå¾ˆåˆ«æ‰­ï¼Œä¹Ÿä¸æ–¹ä¾¿ä¿®æ”¹ã€‚\nå¥½åœ¨ go åœ¨ 1.21 ç‰ˆæœ¬æ–°å¢äº†äº† slices è¿™ä¸ªæ³›å‹åº“ï¼Œé‡Œé¢åŒ…å«äº†å¾ˆå¤šåˆ‡ç‰‡çš„é€šç”¨æ“ä½œï¼Œå…¶ä¸­çš„ slices.Sort å’Œ slices.SortFunc å‡½æ•°å°±å¯ä»¥é¿å…ä¸Šé¢çš„å‘ã€‚\nè¿™ä¸¤ä¸ªå‡½æ•°çš„ç­¾åï¼š\nfunc Sort[S ~[]E, E cmp.Ordered](x S) func SortFunc[S ~[]E, E any](x S, cmp func(a, b E) int) ä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥ä¼ å…¥è¦æ’åºçš„éƒ¨åˆ†ï¼Œå¦‚æœè°ƒç”¨ slices.Sortï¼Œè¿˜å¯ä»¥çœå»ç”¨æ‰‹å†™ less é—­åŒ…å‡½æ•°ã€‚ æœ€é‡è¦çš„æ˜¯ï¼ŒæŒ‰ç…§ç›´è§‰ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°å°±å¯ä»¥é¿å… sort.Slices åœ¨éƒ¨åˆ†æ’åºæ—¶çš„å‘ï¼š\nfunc main() { nums := []int{2, 3, 1, 5, 4, 6, 7} tests := []struct { p int want []int }{ {p: 0, want: []int{1, 2, 3, 4, 5, 6, 7}}, {p: 1, want: []int{2, 1, 3, 4, 5, 6, 7}}, {p: 2, want: []int{2, 3, 1, 4, 5, 6, 7}}, {p: 3, want: []int{2, 3, 1, 4, 5, 6, 7}}, } for _, tt := range tests { got := slices.Clone(nums) // æ‹·è´åŸå§‹æ•°æ®ï¼Œç”¨äºæµ‹è¯• slices.Sort(got[tt.p:]) if !reflect.DeepEqual(got, tt.want) { fmt.Printf(\u0026#34;when p: %v ,want: %v, but got: %v\\n\u0026#34;, tt.p, tt.want, got) } } } è€Œä½¿ç”¨ sort.SortFuncï¼Œæ­é… go 1.22 æ–°å¢çš„æ³›å‹å‡½æ•° cmp.Orï¼Œå¯ä»¥æ›´è½»æ¾çš„å®ç°å¤šå­—æ®µæ’åºï¼Œè¿™æ®µä»£ç æ¥è‡ª go1.22 æ ‡å‡†åº“ cmp/cmp_test.goï¼š\nfunc main() { type Order struct { Product string Customer string Price float64 } orders := []Order{ {\u0026#34;foo\u0026#34;, \u0026#34;alice\u0026#34;, 1.00}, {\u0026#34;bar\u0026#34;, \u0026#34;bob\u0026#34;, 3.00}, {\u0026#34;baz\u0026#34;, \u0026#34;carol\u0026#34;, 4.00}, {\u0026#34;foo\u0026#34;, \u0026#34;alice\u0026#34;, 2.00}, {\u0026#34;bar\u0026#34;, \u0026#34;carol\u0026#34;, 1.00}, {\u0026#34;foo\u0026#34;, \u0026#34;bob\u0026#34;, 4.00}, } // Sort by customer first, product second, and last by higher price slices.SortFunc(orders, func(a, b Order) int { return cmp.Or( cmp.Compare(a.Customer, b.Customer), cmp.Compare(a.Product, b.Product), cmp.Compare(b.Price, a.Price), ) }) for _, order := range orders { fmt.Printf(\u0026#34;%s %s %.2f\\n\u0026#34;, order.Product, order.Customer, order.Price) } } // Output: // foo alice 2.00 // foo alice 1.00 // bar bob 3.00 // foo bob 4.00 // bar carol 1.00 // baz carol 4.00 å…¶ä¸­ cmp.Or çš„æºç  éå¸¸ç®€å•ï¼Œåªæ˜¯ç”¨äºæ‰¾å‡ºåˆ‡ç‰‡ä¸­ç¬¬ä¸€ä¸ªéé›¶çš„å…ƒç´ ï¼š\n// Or returns the first of its arguments that is not equal to the zero value. // If no argument is non-zero, it returns the zero value. func Or[T comparable](vals ...T) T { var zero T for _, val := range vals { if val != zero { return val } } return zero } å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·å†™ less å‡½æ•°ï¼Œæ¯”æ‰‹å†™å¤šä¸ª if ä¼˜é›…å¤ªå¤šäº†ã€‚\nå‚è€ƒèµ„æ–™ golang sort.Sliceè¸©å‘è®°å½• - ç®€ä¹¦ ","date":"2023-03-11T00:00:00Z","image":"https://niluan304.github.io/p/sort.slice-%E4%B8%8D%E9%80%82%E5%90%88%E9%83%A8%E5%88%86%E6%8E%92%E5%BA%8F/Feng_2024-03-12_10-13-25_huca69348bf10406e412f1d3e0ec3bf9be_11506_120x120_fill_box_smart1_3.png","permalink":"https://niluan304.github.io/p/sort.slice-%E4%B8%8D%E9%80%82%E5%90%88%E9%83%A8%E5%88%86%E6%8E%92%E5%BA%8F/","title":"sort.Slice ä¸é€‚åˆéƒ¨åˆ†æ’åº"},{"content":"wsl å¸¸ç”¨å‘½ä»¤ é‡å¯ wsl å°è¯•é‡å¯ wslï¼Œä½¿ç”¨å‘½ä»¤ wsl --shuntdown æˆ–å…¶ä»–å‘½ä»¤ï¼Œç»ˆç«¯è¢«æŒ‚èµ·ï¼Œæ— ååº”ã€‚\nè§£å†³åŠæ³•ï¼škill LxssManager\næ‰¾åˆ° svchost.exe è¿›ç¨‹çš„ pid, ç„¶ååœ¨ã€Œä»»åŠ¡ç®¡ç†å™¨/è¯¦ç»†ä¿¡æ¯ã€é‡Œç»“æŸè¿™ä¸ªè¿›ç¨‹ echo å¯»æ‰¾ `pid` çš„æŒ‡ä»¤ï¼š tasklist /svc /fi \u0026#34;imagename eq svchost.exe\u0026#34; | findstr LxssManager PowerShell7 é‡Œ kill LxssManager echo åœ¨ `PowerShell7` é‡Œè¿è¡Œï¼ˆå¯èƒ½éœ€è¦ç®¡ç†å‘˜å¯åŠ¨ï¼‰ï¼š Stop-Process -Id $(Get-CimInstance -ClassName Win32_Service -Filter \u0026#34;Name=\u0026#39;LxssManager\u0026#39;\u0026#34;).ProcessId -Force å®‰è£… docker æœ€ç®€å•çš„åŠæ³•ï¼Œå¤§æ¦‚æ˜¯å®‰è£… Docker Desktopï¼Œç¬”è€…ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´ï¼Œä¼¼ä¹æœ‰å…¼å®¹æ€§é—®é¢˜ï¼ˆå¯èƒ½å’Œç¬”è€…åŒæ—¶ä½¿ç”¨ Hyper-V å®‰å“æ¨¡æ‹Ÿå™¨æœ‰å…³ç³»ï¼‰ï¼Œäºæ˜¯åˆæ›´æ¢ä¸º Linux ç‰ˆæœ¬çš„ dockerã€‚\nç›´æ¥è¿è¡Œå®˜æ–¹çš„è„šæœ¬ï¼Œå³å¯å®Œæˆå®‰è£…ï¼š\ncurl -fsSL https://get.docker.com -o get-docker.sh sudo sh get-docker.sh sudo service docker start ä½†æ˜¯ç¬”è€…çš„æœºå™¨å®‰è£…è¿‡ Docker Desktopï¼Œè¿è¡Œ service docker start åæ˜¾ç¤ºï¼š\nCannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running? ç»è¿‡æ’æŸ¥ï¼Œå‘ç°è¿˜éœ€è¦æ¸…ç† Docker Desktop ç›¸å…³çš„é…ç½®ã€‚å®‰è£…è¿‡ Docker Desktopï¼Œæ‰€ä»¥ docker çš„é…ç½®æ–‡ä»¶ /root/.docker/config.json å«æœ‰è¿™ä¸ªé…ç½®é¡¹ï¼š\n{ \u0026#34;credsStore\u0026#34;: \u0026#34;desktop.exe\u0026#34; } docker ä¼šå› ä¸ºé…ç½®äº† \u0026quot;credsStore\u0026quot; å­—æ®µå»è¿è¡Œ \u0026quot;desktop.exe\u0026quot;ï¼Œè€Œè¿™ä¸ªç¨‹åºå°±æ˜¯ Docker Desktpoï¼Œæ‰å¯¼è‡´ docker æ— æ³•å¯åŠ¨ã€‚\nè§£å†³åŠæ³•ï¼š\nåˆ é™¤ docker é…ç½®æ–‡ä»¶é‡Œçš„ \u0026quot;credsStore\u0026quot; å­—æ®µã€‚ å¦‚æœé‡Œé¢çš„é…ç½®ä¸é‡è¦ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼šrm /root/.docker/config.jsonã€‚ ","date":"2023-02-10T10:28:36+08:00","permalink":"https://niluan304.github.io/p/wsl-%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/","title":"Wsl ä½¿ç”¨ç¬”è®°"}]